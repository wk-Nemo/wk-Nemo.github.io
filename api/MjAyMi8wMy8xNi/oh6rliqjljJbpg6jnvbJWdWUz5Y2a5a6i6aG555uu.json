{"title":"è‡ªåŠ¨åŒ–éƒ¨ç½²Vue3åšå®¢é¡¹ç›®","date":"2022-03-16T13:53:09.000Z","date_formatted":{"ll":"Mar 16, 2022","L":"03/16/2022","MM-DD":"03-16"},"link":"2022/03/16/è‡ªåŠ¨åŒ–éƒ¨ç½²Vue3åšå®¢é¡¹ç›®","categories":["Vue","å‰ç«¯"],"updated":"2023-05-07T09:46:04.987Z","content":"<p>æœ€è¿‘åœ¨å¼€å‘è‡ªå·±çš„åšå®¢ç³»ç»Ÿï¼Œæ¯æ¬¡è¿­ä»£å®Œä¸€æ¬¡ä»£ç å°±è¦é‡æ–°æ‰‹åŠ¨éƒ¨ç½²ä¸€æ¬¡ï¼Œæœ‰æ—¶å€™éƒ¨ç½²åæ‰å‘ç°ä¸€äº›bugï¼Œåˆè¦å›è¿‡å¤´æ¥é‡æ–°éƒ¨ç½²ï¼Œååˆ†çš„éº»çƒ¦ã€‚è‡ªå·±çš„é¡¹ç›®æ‰˜ç®¡åœ¨githubä¸Šï¼Œå› æ­¤æƒ³å®ç°æ¯æ¬¡pushå®Œä»£ç åˆ°masteråˆ†æ”¯ä¸Šåï¼Œgithubå¯ä»¥è‡ªåŠ¨çš„å¸®æˆ‘è¿›è¡Œéƒ¨ç½²è¿™ä¸€æ­¥éª¤ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…é¢‘ç¹çš„æ‰‹åŠ¨éƒ¨ç½²ã€‚</p>\n<h2 id=\"0-æˆ‘çš„åšå®¢\">0 æˆ‘çš„åšå®¢<a title=\"#0-æˆ‘çš„åšå®¢\" href=\"#0-æˆ‘çš„åšå®¢\"></a></h2>\n<p>çº¿ä¸Šåœ°å€ï¼š<a href=\"http://travel.wutortoise.cn/\" target=\"_blank\">wk-blog</a></p>\n<p>github åœ°å€ï¼š<a href=\"https://github.com/wk-Nemo/wk-blog\" target=\"_blank\">é¡¹ç›® github</a></p>\n<p>é¡¹ç›®ç®€ä»‹ï¼šé¡¹ç›®é‡‡ç”¨çš„æ˜¯å‰åç«¯åˆ†ç¦»çš„æ¨¡å¼ï¼Œå‰ç«¯çš„ä¸»è¦æŠ€æœ¯æ¡†æ¶æ˜¯ Vue3ï¼Œåç«¯ä½¿ç”¨çš„æ˜¯ express</p>\n<p>åšå®¢é¢„è§ˆï¼š</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d7dd082a5294115becfb1df7e6e370f~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<h2 id=\"1-github-actions-ç®€ä»‹\">1 Github Actions ç®€ä»‹<a title=\"#1-github-actions-ç®€ä»‹\" href=\"#1-github-actions-ç®€ä»‹\"></a></h2>\n<blockquote>\n<p>å‚è€ƒæ–‡ç« ï¼š</p>\n<ul>\n<li><a href=\"https://zhuanlan.zhihu.com/p/433426848\" target=\"_blank\">GitHub Actionsè‡ªåŠ¨åŒ–éƒ¨ç½²å‰ç«¯é¡¹ç›®æŒ‡å—</a></li>\n<li><a href=\"https://juejin.cn/post/7003278731171069982\" target=\"_blank\">ä½¿ç”¨Github Actionsæ¥å®ç°é¡¹ç›®çš„CI/CD</a></li>\n</ul>\n</blockquote>\n<p>åœ¨æˆ‘ä»¬å‰ç«¯å¸¸è§„çš„å¼€å‘æµç¨‹ä¸­ï¼Œæ¯æ¬¡å‘è¿œç¨‹åˆ†æ”¯æ¨é€å®Œæœ¬æ¬¡ä»£ç åï¼Œæ¥ä¸‹æ¥è¿›è¡Œçš„å°±æ˜¯<strong>æ‰“åŒ…ç”Ÿæˆé™æ€èµ„æº</strong>ï¼Œå†<strong>æ¨é€è‡³æœåŠ¡å™¨</strong>ã€‚è¿™äº›æ­¥éª¤çš„ç‰¹ç‚¹å°±æ˜¯åœ¨ä¸åŒçš„é¡¹ç›®ä¸­æ˜¯ç±»ä¼¼çš„ï¼Œä¸”éœ€è¦åå¤é‡å¤è¿™äº›æ­¥éª¤ã€‚æœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åœ¨æ¯æ¬¡pushå®Œä»£ç åï¼Œè‡ªåŠ¨çš„å»æ‰§è¡Œè¿™äº›é‡å¤çš„åŠ¨ä½œå‘¢ï¼ŸGiuthub Actions å°±å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸€ä¸ªé—®é¢˜ã€‚</p>\n<p>GitHub Actions æ˜¯ GitHub æ¨å‡ºçš„ä¸€æ¬¾æŒç»­é›†æˆï¼ˆCI/CDï¼‰æœåŠ¡ï¼Œå®ƒç»™æˆ‘ä»¬æä¾›äº†è™šæ‹Ÿçš„æœåŠ¡å™¨èµ„æºï¼Œè®©æˆ‘ä»¬å¯ä»¥åŸºäºå®ƒå®Œæˆè‡ªåŠ¨åŒ–æµ‹è¯•ã€é›†æˆã€éƒ¨ç½²ç­‰æ“ä½œï¼ŒGithub æŠŠè¿™äº›æ“ä½œç§°ä½œ actionsã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨pushå®Œä»£ç åæ‰§è¡ŒæŸä¸€ä¸ªactionï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•ç”¨ä»–äººå†™å¥½çš„ action å³å¯ã€‚</p>\n<p>å®˜æ–¹æ–‡æ¡£ä¼ é€é—¨ï¼š<a href=\"https://docs.github.com/cn/actions\" target=\"_blank\">Github Actions</a></p>\n<h3 id=\"1.1-åŸºæœ¬æ¦‚å¿µ\">1.1 åŸºæœ¬æ¦‚å¿µ<a title=\"#1.1-åŸºæœ¬æ¦‚å¿µ\" href=\"#1.1-åŸºæœ¬æ¦‚å¿µ\"></a></h3>\n<p><strong>workflow</strong> ï¼ˆå·¥ä½œæµç¨‹ï¼‰ï¼šæŒç»­é›†æˆä¸€æ¬¡è¿è¡Œçš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä¸€ä¸ª workflowã€‚</p>\n<ul>\n<li>nameï¼šå·¥ä½œæµç¨‹çš„åç§°</li>\n<li>onï¼šè§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶åç§°</li>\n</ul>\n<p><strong>job</strong> ï¼ˆä»»åŠ¡ï¼‰ï¼šä¸€ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª jobs æ„æˆï¼Œå«ä¹‰æ˜¯ä¸€æ¬¡æŒç»­é›†æˆçš„è¿è¡Œï¼Œå¯ä»¥å®Œæˆå¤šä¸ªä»»åŠ¡ã€‚</p>\n<ul>\n<li>\n<p>runs-onï¼šä»»åŠ¡è¿è¡Œçš„è™šæ‹Ÿç¯å¢ƒ</p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ç›®å‰å¯ç”¨çš„ç¯å¢ƒ</span><br><span class=\"line\">Windows Server 2019     windows-latest æˆ– windows-2019</span><br><span class=\"line\">Ubuntu 20.04            ubuntu-20.04</span><br><span class=\"line\">Ubuntu 18.04            ubuntu-latest æˆ– ubuntu-18.04</span><br><span class=\"line\">Ubuntu 16.04            ubuntu-16.04</span><br><span class=\"line\">macOS Catalina 10.15    macos-latest æˆ– macos-10.15</span><br><span class=\"line\"></span><br><span class=\"line\"># ä½¿ç”¨</span><br><span class=\"line\">runs-on: ubuntu-latest</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><strong>step</strong>ï¼ˆæ­¥éª¤ï¼‰ï¼šæ¯ä¸ª job ç”±å¤šä¸ª step æ„æˆï¼Œä¸€æ­¥æ­¥å®Œæˆã€‚</p>\n<ul>\n<li>nameï¼šæ­¥éª¤åç§°</li>\n<li>runï¼šè¯¥æ­¥éª¤çš„å‘½ä»¤æˆ– action</li>\n<li>envï¼šæ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡</li>\n<li>usesï¼šé€‰æ‹©ä»»åŠ¡æ­¥éª¤ä¸­ä¸€éƒ¨åˆ†è¿è¡Œçš„æ“ä½œã€‚å…¶å®å°±æ˜¯æ­¥éª¤ä½¿ç”¨çš„<code>actions</code>ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª</li>\n</ul>\n<p><strong>action</strong> ï¼ˆåŠ¨ä½œï¼‰ï¼šæ¯ä¸ª step å¯ä»¥ä¾æ¬¡æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ï¼ˆactionï¼‰ã€‚å› ä¸ºå¾ˆå¤šæ“ä½œåœ¨ä¸åŒé¡¹ç›®ä¸­éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œæ‰€ä»¥ GitHub æŠŠ action è®¾è®¡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬æ–‡ä»¶ï¼Œå¯ä»¥å­˜æ”¾åˆ°ä»£ç ä»“åº“é‡Œï¼Œè®©å…¶ä»–å¼€å‘è€…ä½¿ç”¨ã€‚æ‰€ä»¥åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åˆ«äººå†™å¥½çš„ action è€Œä¸å¿…æ‰€æœ‰çš„éƒ½è‡ªå·±å†™ã€‚GitHubä¹Ÿä¸ºæ­¤åšäº†ä¸€ä¸ª<a href=\"https://github.com/marketplace?type=actions\" target=\"_blank\">marketplace</a>ï¼Œè¿™é‡Œå°±æ˜¯actionçš„å®˜æ–¹å¸‚åœºã€‚</p>\n<h2 id=\"2-github-actions-å°å®éªŒ\">2 Github Actions å°å®éªŒ<a title=\"#2-github-actions-å°å®éªŒ\" href=\"#2-github-actions-å°å®éªŒ\"></a></h2>\n<blockquote>\n<p>å®éªŒä»£ç ï¼š<a href=\"https://github.com/wk-Nemo/CI-CD\" target=\"_blank\">CI-CD</a></p>\n</blockquote>\n<p>æœ¬æ¬¡å®éªŒçš„ç›®çš„æ˜¯å®ç° vue é¡¹ç›®çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚å½“æˆ‘ä»¬æœ¬åœ°å¼€å‘å®Œé¡¹ç›®å‘è¿œç¨‹åˆ†æ”¯æ¨é€ä»£ç æ—¶ï¼ŒGitHubä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨æ„å»ºï¼Œç”Ÿæˆé™æ€èµ„æºï¼Œå¹¶éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚</p>\n<p>å®éªŒå¤§è‡´åˆ†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>\n<ul>\n<li>å‡†å¤‡å¥½æœåŠ¡ç¯å¢ƒ</li>\n<li>åˆ›å»º github é¡¹ç›®å¹¶åˆ›å»º workflow</li>\n<li>æ‹‰å– github ä»“åº“ï¼Œå¹¶æ–°å»ºä¸€ä¸ª vue é¡¹ç›®ï¼Œæœ¬åœ° push ä»£ç </li>\n<li>æŸ¥çœ‹è‡ªåŠ¨åŒ–éƒ¨ç½²æ˜¯å¦å®Œæˆ</li>\n</ul>\n<h3 id=\"step1-æœåŠ¡ç¯å¢ƒå‡†å¤‡\">step1 æœåŠ¡ç¯å¢ƒå‡†å¤‡<a title=\"#step1-æœåŠ¡ç¯å¢ƒå‡†å¤‡\" href=\"#step1-æœåŠ¡ç¯å¢ƒå‡†å¤‡\"></a></h3>\n<p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„è½»é‡æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæ˜¯ ubuntu-20.04ã€‚</p>\n<p>è¿™é‡Œä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„æœåŠ¡å™¨ï¼Œ<strong>å®‰è£…çš„æ“ä½œç³»ç»Ÿè‡ªå·±ä¹Ÿè¦è®°ä½</strong>ï¼Œå› ä¸ºåœ¨åé¢æˆ‘ä»¬ä¼šä½¿ç”¨åˆ°ã€‚æˆ‘ä»¬è¿›å…¥è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ Linux å‘½ä»¤åˆ›å»ºå¥½å­˜æ”¾é™æ€èµ„æºçš„æ–‡ä»¶å¤¹ï¼Œä½ å¯ä»¥é€‰æ‹©è‡ªå·±å¸¸ç”¨çš„æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯<strong>éœ€è¦è®°ä½è¿™ä¸ªè·¯å¾„</strong>ï¼Œåé¢ä¼šä½¿ç”¨åˆ°ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯æˆ‘éƒ¨ç½²é¡¹ç›®çš„åœ°æ–¹ï¼Œä½ å¯ä»¥é€‰æ‹©è‡ªå·±å¸¸ç”¨çš„æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯éœ€è¦è®°ä½è¿™ä¸ªè·¯å¾„ï¼Œåé¢ä¼šä½¿ç”¨åˆ°</span><br><span class=\"line\">cd /www</span><br><span class=\"line\">sudo mkdir actionTest</span><br></pre></td></tr></table></figure>\n<h3 id=\"step2-åˆ›å»º-github-é¡¹ç›®\">step2 åˆ›å»º github é¡¹ç›®<a title=\"#step2-åˆ›å»º-github-é¡¹ç›®\" href=\"#step2-åˆ›å»º-github-é¡¹ç›®\"></a></h3>\n<p>åœ¨ github ä¸Šæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œè¿™å¾ˆ easyï¼Œä¸å¤šèµ˜è¿°ã€‚</p>\n<p>å› ä¸ºéœ€è¦è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œåœ¨åˆ›å»º workflow ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€äº›éœ€è¦ä½¿ç”¨çš„<strong>æš—å·</strong>ã€‚è¿™ä¸ªæš—å·å°±æ˜¯ä¸€ä¸ª<strong>å˜é‡å</strong>ï¼Œç„¶åå®ƒçš„å€¼åªæœ‰ä½ å’Œ Github çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„åœ°æ–¹ä½¿ç”¨è¿™ä¸ªå˜é‡åï¼ŒGithubä¾¿èƒ½é¢†ä¼šåˆ°è¿™æ˜¯ä¸€ä¸ªç§å¯†çš„ä¿¡æ¯ï¼Œå¹¶åœ¨æ‰§è¡Œæµç¨‹æ—¶ä½¿ç”¨å®ƒ<strong>çœŸæ­£çš„å€¼</strong>å»ä»£æ›¿å˜é‡åã€‚</p>\n<p><img src=\"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c6eaa6fac4e4f0bac39a242bf4f09cb~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>æŒ‰ç…§ä¸Šé¢çš„é¡ºåºæˆ‘ä»¬ä¾¿å¯ä»¥åˆ›å»ºæš—å·äº†ã€‚æˆ‘ä»¬ä»¥æ­¤å»ºç«‹ä¸‰ä¸ªæš—å·ï¼Œä»–ä»¬çš„å˜é‡ååˆ†åˆ«æ˜¯ï¼š</p>\n<ul>\n<li>DR_HOSTï¼šä½ çš„æœåŠ¡å™¨IPåœ°å€</li>\n<li>DR_USERï¼šä½ çš„æœåŠ¡å™¨è´¦å·ï¼Œä¸€èˆ¬æ˜¯ root</li>\n<li>DR_PASSï¼šä½ çš„ SSH ç™»å½•å¯†ç </li>\n</ul>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c548432ddf54f2a89af38cc5acb310b~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>å‡†å¤‡å¥½ä¸Šé¢çš„å†…å®¹æˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ª workflow äº†</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8f71fcd268034f4bb594ae29fade60e9~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8ba9f8b9f47e44b5bbc4313e9bb5e2b9~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>æœ€åæˆ‘ä»¬èƒ½çœ‹åˆ°å¦‚ä¸‹çš„ç•Œé¢ï¼š</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d72099cab904324970f10a81564246b~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>æˆ‘ä»¬å°†é‡Œé¢çš„ä»£ç åˆ é™¤ï¼Œå¹¶æ¢æˆä¸‹é¢çš„ä»£ç </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name: build</span><br><span class=\"line\">on: </span><br><span class=\"line\">  push: </span><br><span class=\"line\">    branches: </span><br><span class=\"line\">      - main # è¿™é‡Œè¡¨ç¤ºpushåˆ°mainåˆ†æ”¯å°±ä¼šè§¦å‘æµç¨‹</span><br><span class=\"line\">jobs:</span><br><span class=\"line\">  build-and-deploy:</span><br><span class=\"line\">    runs-on: ubuntu-20.04</span><br><span class=\"line\">    steps:</span><br><span class=\"line\">      # è¿™æ˜¯githubå®˜æ–¹çš„ä¸€ä¸ªactionï¼Œç”¨äºcloneè¯¥ä»“åº“çš„æºç åˆ°å·¥ä½œæµä¸­ï¼Œ</span><br><span class=\"line\">      - name: Checkout ğŸ›ï¸</span><br><span class=\"line\">        uses: actions/checkout@v2</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          persist-credentials: false</span><br><span class=\"line\"></span><br><span class=\"line\">      - name: Build</span><br><span class=\"line\">        run: |</span><br><span class=\"line\">          cd my-project # è¿›å…¥é¡¹ç›®ç›®å½•</span><br><span class=\"line\">          npm install  # å®‰è£…ä¾èµ–</span><br><span class=\"line\">          npm run build  # æ‰§è¡Œæ‰“åŒ…</span><br><span class=\"line\">  </span><br><span class=\"line\">      # è¿æ¥åˆ°sshï¼Œå¹¶ä¸”åšä¸€ä¸ªæ‹·è´æ“ä½œçš„action</span><br><span class=\"line\">      - name: Deploy ğŸš€</span><br><span class=\"line\">        uses: cross-the-world/scp-pipeline@master</span><br><span class=\"line\">        env:</span><br><span class=\"line\">          WELCOME: &quot;ssh scp ssh pipelines&quot;</span><br><span class=\"line\">          LASTSSH: &quot;Doing something after copying&quot;</span><br><span class=\"line\">        with:</span><br><span class=\"line\">         host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class=\"line\">         user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class=\"line\">         pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class=\"line\">         connect_timeout: 10s</span><br><span class=\"line\">         local: &#x27;./my-project/dist/*&#x27; # è¿™é‡Œæ˜¯ä¸‹ä¸€æ­¥è¦åˆ›å»ºçš„vueé¡¹ç›®æ„å»ºå®Œæˆåçš„é™æ€èµ„æºè·¯å¾„</span><br><span class=\"line\">         remote: /www/actionTest # è¿™é‡Œæ˜¯ step1 ä¸­ï¼Œåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºç”¨äºå­˜æ”¾é™æ€èµ„æºçš„æ–‡ä»¶å¤¹</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>æœ€åæˆ‘ä»¬æäº¤è¿™éƒ¨åˆ†ä»£ç ,è¿™é‡Œç›¸å½“äºåœ¨githubä»“åº“åˆ›å»ºäº†ä¸€ä¸ª <code>/.github/workflows/build.yml</code> çš„æ–‡ä»¶</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/154ed8ae17d04705b73d66190c067ddf~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>è¿™é‡Œæˆ‘ä»¬ç›¸å½“äºæäº¤äº†ä¸€æ¬¡ä»£ç åˆ° main åˆ†æ”¯ä¸Šï¼Œå› æ­¤ä¼šæ‰§è¡Œæµç¨‹ï¼Œä½†å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰åˆ›å»º vue é¡¹ç›®ï¼Œå› æ­¤æµç¨‹ä¸ä¼šæ‰§è¡ŒæˆåŠŸã€‚æˆ‘ä»¬æ¥ç€è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>\n<h3 id=\"step3-æœ¬åœ°å¼€å‘\">step3 æœ¬åœ°å¼€å‘<a title=\"#step3-æœ¬åœ°å¼€å‘\" href=\"#step3-æœ¬åœ°å¼€å‘\"></a></h3>\n<blockquote>\n<p>Vueè„šæ‰‹æ¶å®˜ç½‘ä¼ é€åœ°å€ï¼š<a href=\"https://cli.vuejs.org/\" target=\"_blank\">Vue CLI</a></p>\n</blockquote>\n<p>æ¥ç€æˆ‘ä»¬æ‹‰å–è¿œç¨‹åˆ†æ”¯çš„ä»£ç ï¼Œå¹¶ä½¿ç”¨ vue-cli åˆ›å»ºä¸€ä¸ª vue é¡¹ç›®ï¼Œæœ€åå†æäº¤ä»£ç åˆ° main åˆ†æ”¯ä¸Šã€‚</p>\n<h3 id=\"step4-éªŒè¯å®éªŒç»“æœ\">step4 éªŒè¯å®éªŒç»“æœ<a title=\"#step4-éªŒè¯å®éªŒç»“æœ\" href=\"#step4-éªŒè¯å®éªŒç»“æœ\"></a></h3>\n<p>åœ¨ github ä¸­çš„ action ä¸­å¯ä»¥æŸ¥çœ‹åˆ°å·¥ä½œæµç¨‹æ­£å¸¸æ‰§è¡Œ</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5877fc69c0624946b9cd8eb04e14b27f~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>ç‚¹è¿›å»ä¹Ÿå¯ä»¥çœ‹åˆ°æ ¸å¿ƒçš„ build å’Œ deploy ä¹Ÿæ­£å¸¸æ‰§è¡Œäº†</p>\n<ul>\n<li>\n<p>æ­£å¸¸æ„å»º<br>\n<img src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f75de66214ad478393acedce96ce0268~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\"></p>\n</li>\n<li>\n<p>æ­£å¸¸éƒ¨ç½²<br>\n<img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04f6dbf583164909811ed1d9db6c07da~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\"></p>\n</li>\n</ul>\n<p>æˆ‘ä»¬å†ä¸ŠæœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼Œå¯ä»¥å‘ç° vue é¡¹ç›®æ‰“åŒ…åçš„ dist ä¸­çš„å†…å®¹æ­£å¸¸éƒ¨ç½²åˆ°äº†æˆ‘ä»¬æœåŠ¡å™¨çš„ç›®æ ‡æ–‡ä»¶å¤¹ä¸­</p>\n<p><img src=\"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/967828d16050447b8c06d0949bf72e1f~tplv-k3u1fbpfcp-watermark.image?\" alt=\"image.png\" loading=\"lazy\" class=\"Ï†bp\"></p>\n<h2 id=\"3-åšå®¢é¡¹ç›®éƒ¨ç½²è¸©å‘æ—¥è®°\">3 åšå®¢é¡¹ç›®éƒ¨ç½²è¸©å‘æ—¥è®°<a title=\"#3-åšå®¢é¡¹ç›®éƒ¨ç½²è¸©å‘æ—¥è®°\" href=\"#3-åšå®¢é¡¹ç›®éƒ¨ç½²è¸©å‘æ—¥è®°\"></a></h2>\n<p>åœ¨å¼€å¤´å·²ç»ä»‹ç»è¿‡æˆ‘çš„åšå®¢é¡¹ç›®ï¼Œå‰ç«¯ä½¿ç”¨çš„æ˜¯ vue3ï¼Œå…·ä½“çš„éƒ¨ç½²å’Œä¸Šè¿°å®éªŒå·®ä¸å¤šã€‚ä½†æ˜¯ä¸­é—´åœ¨æ‰§è¡Œ npm install æ—¶é‡åˆ°äº†é—®é¢˜ï¼Œæœ€åé€šè¿‡æŒ‡å®š node ç‰ˆæœ¬è§£å†³äº†é—®é¢˜ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name: frontend-build</span><br><span class=\"line\">on: </span><br><span class=\"line\">  push: </span><br><span class=\"line\">    branches: </span><br><span class=\"line\">      - main</span><br><span class=\"line\">jobs:</span><br><span class=\"line\">  build-and-deploy:</span><br><span class=\"line\">    runs-on: ubuntu-20.04</span><br><span class=\"line\">    steps:</span><br><span class=\"line\">      - name: Checkout ğŸ›ï¸</span><br><span class=\"line\">        uses: actions/checkout@v2</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          persist-credentials: false</span><br><span class=\"line\">      </span><br><span class=\"line\">      # æŒ‡å®š node ç‰ˆæœ¬</span><br><span class=\"line\">      - uses: actions/setup-node@v2 </span><br><span class=\"line\">        with:</span><br><span class=\"line\">          node-version: &#x27;14&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">      - name: Build</span><br><span class=\"line\">        run: |</span><br><span class=\"line\">          cd blog-frontend # è¿›å…¥é¡¹ç›®ç›®å½•</span><br><span class=\"line\">          npm install  # å®‰è£…ä¾èµ–</span><br><span class=\"line\">          npm run build  # æ‰§è¡Œæ‰“åŒ…</span><br><span class=\"line\">  </span><br><span class=\"line\">      - name: Deploy ğŸš€</span><br><span class=\"line\">        uses: cross-the-world/scp-pipeline@master</span><br><span class=\"line\">        env:</span><br><span class=\"line\">          WELCOME: &quot;ssh scp ssh pipelines&quot;</span><br><span class=\"line\">          LASTSSH: &quot;Doing something after copying&quot;</span><br><span class=\"line\">        with:</span><br><span class=\"line\">         host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class=\"line\">         user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class=\"line\">         pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class=\"line\">         connect_timeout: 10s</span><br><span class=\"line\">         local: &#x27;./blog-frontend/dist/*&#x27;</span><br><span class=\"line\">         remote: /www/wk-blog/dist</span><br><span class=\"line\">         last_ssh: |</span><br><span class=\"line\">            nginx -s reload # éƒ¨ç½²æˆåŠŸåéœ€è¦é‡å¯nginx</span><br><span class=\"line\">           </span><br></pre></td></tr></table></figure>\n<p>åç«¯ä»£ç ä½¿ç”¨çš„æ˜¯ expressï¼ŒæœåŠ¡å™¨ä¸Šä½¿ç”¨ pm2 å¼€å¯é¡¹ç›®ã€‚å› ä¸ºæ•°æ®åº“ä¸­çš„åšå®¢ä¿¡æ¯æ˜¯é€šè¿‡ js è„šæœ¬è§£æçš„ï¼Œå› æ­¤æœ€åè¿˜éœ€è¦æ‰§è¡Œè„šæœ¬é‡æ–°è§£ææ‰€æœ‰çš„åšå®¢æ–‡ä»¶ï¼Œå½“ä¸Šä¼ æ–°çš„åšå®¢æ—¶ä¼šæ›´æ–°æ•°æ®åº“ä¸­çš„ä¿¡æ¯ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name: backend-build</span><br><span class=\"line\">on: </span><br><span class=\"line\">  push: </span><br><span class=\"line\">    branches: </span><br><span class=\"line\">      - main</span><br><span class=\"line\">jobs:</span><br><span class=\"line\">  backend:</span><br><span class=\"line\">    runs-on: ubuntu-20.04</span><br><span class=\"line\">    steps:</span><br><span class=\"line\">      - name: Checkout ğŸ›ï¸</span><br><span class=\"line\">        uses: actions/checkout@v2</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          persist-credentials: false</span><br><span class=\"line\">          </span><br><span class=\"line\">      - uses: actions/setup-node@v2</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          node-version: &#x27;14&#x27;</span><br><span class=\"line\">  </span><br><span class=\"line\">      - name: Deploy ğŸš€</span><br><span class=\"line\">        uses: cross-the-world/scp-pipeline@master</span><br><span class=\"line\">        env:</span><br><span class=\"line\">          WELCOME: &quot;ssh scp ssh pipelines&quot;</span><br><span class=\"line\">          LASTSSH: &quot;Doing something after copying&quot;</span><br><span class=\"line\">        with:</span><br><span class=\"line\">         host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class=\"line\">         user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class=\"line\">         pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class=\"line\">         connect_timeout: 10s</span><br><span class=\"line\">         local: &#x27;./express-backend/*&#x27;</span><br><span class=\"line\">         remote: /www/wk-blog/backend</span><br><span class=\"line\">         </span><br><span class=\"line\">      - name: ssh pipelines - npm install</span><br><span class=\"line\">        uses: cross-the-world/ssh-pipeline@master</span><br><span class=\"line\">        env:</span><br><span class=\"line\">          WELCOME: &quot;ssh pipeline&quot;</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class=\"line\">          user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class=\"line\">          pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class=\"line\">          connect_timeout: 10s</span><br><span class=\"line\">          script: |</span><br><span class=\"line\">            cd /www/wk-blog/backend</span><br><span class=\"line\">            npm install</span><br><span class=\"line\">      </span><br><span class=\"line\">      - name: ssh pipelines - read blogs</span><br><span class=\"line\">        uses: cross-the-world/ssh-pipeline@master</span><br><span class=\"line\">        env:</span><br><span class=\"line\">          WELCOME: &quot;ssh pipeline&quot;</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class=\"line\">          user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class=\"line\">          pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class=\"line\">          connect_timeout: 10s</span><br><span class=\"line\">          script: |</span><br><span class=\"line\">            cd /www/wk-blog/backend</span><br><span class=\"line\">            node parse.js</span><br><span class=\"line\">            </span><br><span class=\"line\">      - name: ssh pipelines - restart www</span><br><span class=\"line\">        uses: cross-the-world/ssh-pipeline@master</span><br><span class=\"line\">        env:</span><br><span class=\"line\">          WELCOME: &quot;ssh pipeline&quot;</span><br><span class=\"line\">        with:</span><br><span class=\"line\">          host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class=\"line\">          user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class=\"line\">          pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class=\"line\">          connect_timeout: 10s</span><br><span class=\"line\">          script: |</span><br><span class=\"line\">            cd bin</span><br><span class=\"line\">            pm2 restart www</span><br></pre></td></tr></table></figure>\n","prev":{"title":"å¤§å››ä¸‹å­¦æœŸå­¦ä¹ è®¡åˆ’","link":"2022/03/18/å¤§å››ä¸‹å­¦æœŸå­¦ä¹ è®¡åˆ’"},"next":{"title":"vueæºç é˜…è¯»â€”å…¥å£æµç¨‹","link":"2021/11/25/vueæºç é˜…è¯»ï¼ˆä¸€ï¼‰"},"plink":"http://example.com/2022/03/16/è‡ªåŠ¨åŒ–éƒ¨ç½²Vue3åšå®¢é¡¹ç›®/","toc":[{"id":"0-æˆ‘çš„åšå®¢","title":"0 æˆ‘çš„åšå®¢","index":"1"},{"id":"1-github-actions-ç®€ä»‹","title":"1 Github Actions ç®€ä»‹","index":"2","children":[{"id":"1.1-åŸºæœ¬æ¦‚å¿µ","title":"1.1 åŸºæœ¬æ¦‚å¿µ","index":"2.1"}]},{"id":"2-github-actions-å°å®éªŒ","title":"2 Github Actions å°å®éªŒ","index":"3","children":[{"id":"step1-æœåŠ¡ç¯å¢ƒå‡†å¤‡","title":"step1 æœåŠ¡ç¯å¢ƒå‡†å¤‡","index":"3.1"},{"id":"step2-åˆ›å»º-github-é¡¹ç›®","title":"step2 åˆ›å»º github é¡¹ç›®","index":"3.2"},{"id":"step3-æœ¬åœ°å¼€å‘","title":"step3 æœ¬åœ°å¼€å‘","index":"3.3"},{"id":"step4-éªŒè¯å®éªŒç»“æœ","title":"step4 éªŒè¯å®éªŒç»“æœ","index":"3.4"}]},{"id":"3-åšå®¢é¡¹ç›®éƒ¨ç½²è¸©å‘æ—¥è®°","title":"3 åšå®¢é¡¹ç›®éƒ¨ç½²è¸©å‘æ—¥è®°","index":"4"}],"reading_time":"2563 words in 17 min"}