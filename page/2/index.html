<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="一个前端程序员">
<meta property="og:type" content="website">
<meta property="og:title" content="wk的博客">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="wk的博客">
<meta property="og:description" content="一个前端程序员">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="wk">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>wk的博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">wk的博客</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录技术、学习和生活的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="wk"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">wk</p>
  <div class="site-description" itemprop="description">一个前端程序员</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/wk-Nemo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wk-Nemo" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://juejin.cn/user/3122268755465879" title="掘金 → https:&#x2F;&#x2F;juejin.cn&#x2F;user&#x2F;3122268755465879" rel="noopener me" target="_blank">掘金</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/21/js%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E2%80%94%E2%80%94%E5%81%A5%E5%A3%AE%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/21/js%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E2%80%94%E2%80%94%E5%81%A5%E5%A3%AE%E6%80%A7/" class="post-title-link" itemprop="url">js代码质量——健壮性</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-21 13:40:38" itemprop="dateCreated datePublished" datetime="2022-03-21T13:40:38+08:00">2022-03-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:48:17" itemprop="dateModified" datetime="2023-05-07T17:48:17+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>对于初入职场的我们，最重要的就是学习如何写出高质量的 js 代码。学习的途径也很简单，多看，多写，多总结：</p>
<ul>
<li>多看：看大佬们写的代码，学习他们智慧的结晶</li>
<li>多写：纸上得来终觉浅，不停的敲代码才能发现自己的问题，提升自己</li>
<li>多总结：我一直以来奉行的学习方法有两种——<strong>问题驱动学习</strong>和<strong>输出倒闭输入</strong>。只有自己认真的思考总结过，才能发现很多问题的细节，真正的去掌握知识。</li>
</ul>
<p>当然，<strong>我也是一个初入前端的小菜鸡</strong>，本篇博客有内容或认知上的错误属于正常现象，希望各位观众老爷们不吝赐教。本篇博客也不是一次就完成，后面每次小猪遇到新的问题都会跟进博客，当然也欢迎大家来评论区补充！</p>
<h2 id="0-什么是代码健壮性？"><a href="#0-什么是代码健壮性？" class="headerlink" title="0 什么是代码健壮性？"></a>0 什么是代码健壮性？</h2><p>在学校看论文时就经常遇到鲁棒性，在公司学习时经常听到其他人提到代码的健壮性，所以每每听到周会大佬们讨论时都会莫名觉厉。</p>
<p>健壮性，顾名思义，健康强壮。拿这个词来形容人，就是说明这个人身体健康强壮，在遇到小感冒，跌打损伤，不会让他卧床不起。拿这个词来形容代码，道理也一样，在代码遇到各种个样的异常问题，如读取一个值不是预期类型、查询不到指定的路径等，代码不会轻易的挂掉，而是有它自己的一套措施。</p>
<p>如果你的代码现在还有一碰就倒，并且一蹶不振的现象。不用担心，这篇文章就是帮助你的代码变强的修炼秘籍。</p>
<p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fdingyue.ws.126.net%2F2020%2F0614%2Fbc9bb44ep00qbw7zv0061c000zt00plc.png&refer=http%3A%2F%2Fdingyue.ws.126.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1650426335&t=48153ed46627f80e9cd2ff67a9068c66" alt="strong"></p>
<h2 id="1-函数"><a href="#1-函数" class="headerlink" title="1 函数"></a>1 函数</h2><p><strong>一、函数默认参数妙用</strong></p>
<p><strong>场景：</strong></p>
<p>假设我们又如下的初始化工作需要进行，在代码的最开始我们需要对<code>config</code>对象进行初始化工作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initConfig</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    config.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        item.<span class="property">content</span> = <span class="title class_">Number</span>(item.<span class="property">content</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们不小心忘记给它传递参数，浏览器会报如下错误，提示我们 config 没有 map 方法，因为此时 config 为 undefined</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b0a1055f039343268ed3f1bc6ca600a2~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>解决办法：</strong></p>
<p>我们可以给函数的参数加上一个默认的值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initConfig</span>(<span class="params">config = []</span>) &#123;</span><br><span class="line">    config.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        item.<span class="property">content</span> = <span class="title class_">Number</span>(item.<span class="property">content</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<p>这里我们可以默认设置其他的类型，如字符串、数字、对象等，提高代码的健壮性</p>
<h2 id="2-解构赋值"><a href="#2-解构赋值" class="headerlink" title="2 解构赋值"></a>2 解构赋值</h2><p>**解构： **  ES6 允许按照一定模式，从数组和对象中提取值，对变量进行赋值，这被称为解构</p>
<p><strong>一、数组</strong></p>
<p><strong>场景：</strong></p>
<p>假设我们需要一个数组的值分别给几个变量，我们会使用数组的解构</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handleArr</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们需要结构的数组不能确定值百分之百正确时，也就是没有多或者少时，我们任然按照上面的写法便会出现问题</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a172ac80e8643bfb4ab4edc9cdebae0~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>解决办法：</strong></p>
<p>给解构赋值指定默认值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handleArr</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> [a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="title function_">handleArr</span>(arr)	<span class="comment">// 6</span></span><br></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<p>开发时常用到这种方法一次取出多个值，但是要考虑到解构的值不存在的情况，设置好默认值提高代码的健壮性</p>
<p><strong>二、对象</strong></p>
<p><strong>场景：</strong></p>
<p>对象的场景和数组的原理是一样，只不过对象解构的场景用到得更多。</p>
<p><strong>解决办法：</strong></p>
<p>给对象解构赋值指定默认值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handleObj</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; name, list = [] &#125; = obj</span><br><span class="line">  <span class="keyword">if</span>(name) &#123;</span><br><span class="line">    list.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;add1&#x27;</span>,</span><br><span class="line">  <span class="attr">list</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<p>对象解构的内容可能是字符串、数字、数组或是对象等，对于不同的变量类型，我们需要指定不同的默认值，确保代码的健壮性</p>
<h2 id="3-接口请求"><a href="#3-接口请求" class="headerlink" title="3 接口请求"></a>3 接口请求</h2><p>前面两点讨论的是不要轻易相信前端自己的数据，那么从后端接口传来的数据就更不要轻易相信。</p>
<p><strong>一、后端响应的数据</strong></p>
<p><strong>场景：</strong></p>
<p>假设后后端规定接口响应的内容如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">msg</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">data</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们前端代码可能会这样写</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; code, msg, data &#125;  = <span class="keyword">await</span> <span class="title function_">fetchList</span>()</span><br><span class="line">  data.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果后端接口出现了异常</p>
<ul>
<li>后端接口挂掉，取出来的 data 为 undefined</li>
<li>后端返回的 data 出现异常，不是数组</li>
<li>….</li>
</ul>
<p>那么代码中执行的 map 方法就会报错</p>
<p><strong>解决办法：</strong></p>
<p>为了防止接口不反回 data 字段，我们可以给解构指定默认值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; code, msg, data = [] &#125;  = <span class="keyword">await</span> <span class="title function_">fetchList</span>()</span><br><span class="line">  data.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了防止接口返回的是数组，我们可以对类型进行检查</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; code, msg, data = [] &#125;  = <span class="keyword">await</span> <span class="title function_">fetchList</span>()</span><br><span class="line">  <span class="title class_">Array</span>.<span class="title function_">isArray</span>(data) &amp;&amp; data.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<p>我们约定好的接口传过来的数据可能出现数据不存在，类型对不上等异常错误，在相应地方加上异常的处理提高代码的健壮性</p>
<p><strong>二、异常捕获</strong></p>
<blockquote>
<p>除了接口数据的处理，我们还要做好异常的处理，这里参考一篇博客：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6996315680651870244">JavaScript 中的异常处理</a></p>
</blockquote>
<h2 id="4-lodash"><a href="#4-lodash" class="headerlink" title="4 lodash"></a>4 lodash</h2><p>在进行业务开发时，经常会忽略一些代码健壮性考虑的地方。我们可以使用现有的工具库提升代码健壮性，同时也可以让开发者更关注于业务逻辑的开发。这里推荐的工具库是 lodash。</p>
<blockquote>
<p>文档传送门：<a target="_blank" rel="noopener" href="https://www.lodashjs.com/docs/lodash.get">Lodash中文文档</a></p>
</blockquote>
<p><strong>一、取 object 值</strong></p>
<p>我们在上面提到了使用解构的方法取对象的值，在这里我们可以使用<code>_.get()</code>方法，进而不用再关注可能出现的异常。</p>
<p><strong>方法：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_.<span class="title function_">get</span>(object, path, [defaultValue])</span><br></pre></td></tr></table></figure>

<p>根据 <code>object</code>对象的<code>path</code>路径获取值。 如果解析 value 是 <code>undefined</code> 会以 <code>defaultValue</code> 取代。</p>
<p><strong>参数：</strong></p>
<ol>
<li><code>bject</code> <em>(Object)</em>: 要检索的对象。</li>
<li><code>path</code> <em>(Array|string)</em>: 要获取属性的路径。</li>
<li><code>[defaultValue]</code> <em>(*)</em>: 如果解析值是 <code>undefined</code> ，这值会被返回。</li>
</ol>
<p><strong>返回值：</strong></p>
<p>返回解析的值。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/18/%E5%A4%A7%E5%9B%9B%E4%B8%8B%E5%AD%A6%E6%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/18/%E5%A4%A7%E5%9B%9B%E4%B8%8B%E5%AD%A6%E6%9C%9F%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" class="post-title-link" itemprop="url">大四下学期学习计划</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-18 10:45:09" itemprop="dateCreated datePublished" datetime="2022-03-18T10:45:09+08:00">2022-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:21:42" itemprop="dateModified" datetime="2023-05-07T17:21:42+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93%E6%84%9F%E6%83%B3/" itemprop="url" rel="index"><span itemprop="name">个人总结感想</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="0-写在前面"><a href="#0-写在前面" class="headerlink" title="0 写在前面"></a>0 写在前面</h2><p>从开始学前端起，每个阶段都会给自己制定学习计划和目标，并跟着这份计划持续更新和学习。也正是有了这个习惯，我才能保证自己在学习的每个阶段不迷失方向。比如在刚开始学习前端时，那个寒假我的主要精力放在了 javaScript 的学习上，并学习了框架 Vue；在大三下学期，在我进行人生第一份实习的同时，也在准备春招，恶补了计算机基础知识，如：计算机网络、数据结构和算法、操作系统等；在自己的第二份实习中，主要精力放在了前端知识体系的搭建上，深入学习了 html、css、js、浏览器、Vue框架，并将之前阶段学习的计算机基础、前端知识进行了系统的总结，形成了自己的知识体系，也凭借这段时间的努力拿到了自己满意的 offer。</p>
<p>以前我喜欢使用有道云笔记记录自己的学习计划，并时常更新。但最近自己的博客主体部分搭建完毕，也实现了自动化部署，我可以在自己的网站上记录自己的学习生活，也方便以后自己回顾人生的每个阶段干了什么。十年以后我再回头来看这篇文章，不是一件很有意思的事情吗？</p>
<p>言归正传，这篇姗姗来迟的学习计划博客是我大学生涯的最后一个阶段，希望自己能过一个丰富多彩的大四下学期生涯。</p>
<h2 id="1-提升方向"><a href="#1-提升方向" class="headerlink" title="1 提升方向"></a>1 提升方向</h2><p>知己知彼，方能百战不殆。《高效能人士的七个习惯》将一个人的成功之路分为了三个阶段：依赖期、独立期和互赖期，从我自身来看目前处于从依赖期向独立期过渡的阶段。独立期的意思简单明了，能够独立做事，将自己手头的事情完成。我认为对于一个程序员而言，所谓独立期便是<strong>扎实的基础</strong>、<strong>高质量的完成工作</strong>和<strong>深耕某一领域</strong>。</p>
<p>计算机基础这一块是永远都进行不完的部分，不管处于人生哪一个阶段，都会发现原来这里是这样，推翻自己之前的认知。</p>
<ul>
<li>html、css：css 应该不满足于使用阶段，计划读一本 css 的书</li>
<li>js：js 的原理、怎么写出高质量的代码，这是作为前端工程师的生涯一直离不开的话题</li>
<li>浏览器：秋招初步了解了一些原理性的东西，但是有计划还是要亲自去走一遭，毕竟自己沿路看到的风景和他人记录下来的还是有很大的差别</li>
<li>node：包管理机制、常见后端框架原理等，node帮助我们前端工程师进化成大前端，更乃至全栈工程师</li>
<li>vue、react框架：吃饭的家伙，重要性不用我多说</li>
<li>构建工具：webpack、vite等，在前端工程化中扮演者重要的角色</li>
<li>其他开发：微信小程序、h5、flutter、uniapp、ios、安卓等，多去了解，不单单局限于网页的开发</li>
</ul>
<p>随着前端项目日渐复杂，大型项目的管理和组织的合理性决定了项目的成败，也正是这一点上的经验，可以形成前端工程师的行业壁垒。常见的研发流水线如下：需求分析、开发方案设计、业务开发、单元测试、联调、QA测试、发布上线、后期运维</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8ceaec38304c443c830a121f78a6a54b~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<ul>
<li>工程搭建<ul>
<li>git：代码管理</li>
<li>脚手架：去除重复性的工作，让项目搭建变得更加简单和可配置话</li>
<li>前端架构设计：单页面、微前端等</li>
</ul>
</li>
<li>业务开发：<ul>
<li>高质量的代码，需要不断学习前辈的编码经验，多看、多学、多敲</li>
<li>可重复单元沉淀：组件、逻辑库</li>
</ul>
</li>
<li>发布上线 CI&#x2F;CD<ul>
<li>持续集成：代码卡控，代码测试</li>
<li>持续部署：自动化的打包部署，省去人力</li>
</ul>
</li>
<li>可靠性保证：<ul>
<li>监控日志：业务检测、报警、及时解决bug</li>
<li>技术指标度量</li>
</ul>
</li>
</ul>
<p>前端技术的技术特点是更新迭代快，每年都会有新的术语出现，新的技术潮流，要保证自己的持续学习。下面几个是自己最近感兴趣的方向：</p>
<ul>
<li>微前端：多团队合作前端架构</li>
<li>Vue3：源码层次的学习</li>
<li>服务端渲染：更好的SEO、更好的用户体验</li>
<li>编译构建：webpack等构建工具，影响着线上打包的代码，开发时的效率</li>
</ul>
<h2 id="近期计划-amp-amp-阅读计划"><a href="#近期计划-amp-amp-阅读计划" class="headerlink" title="近期计划 &amp;&amp; 阅读计划"></a>近期计划 &amp;&amp; 阅读计划</h2><ul>
<li>git 基本操作学习</li>
<li>ci&#x2F;cd：持续集成和持续部署</li>
<li>js学习<ul>
<li>阅读大佬们的代码</li>
<li>代码重构：阅读《重构：改善既有的代码设计》</li>
<li>js原理：阅读《你不知道的js》</li>
</ul>
</li>
<li>vue<ul>
<li>原理了解：阅读《Vue.js设计与实现》</li>
<li>vue3源码阅读</li>
</ul>
</li>
<li>css：阅读《CSS世界》</li>
<li>脚手架</li>
<li>构建工具<ul>
<li>webpack使用 + 原理学习</li>
<li>vite使用 + 原理学习</li>
</ul>
</li>
</ul>
<h2 id="3-23"><a href="#3-23" class="headerlink" title="3.23"></a>3.23</h2><p>首先说一下 git，在公司又重新学习了如何使用，并沉淀了一篇文章，后面有时间再搬出来。</p>
<p>ci&#x2F;cd 这一块了解了 github action，并对自己的博客做了自动化部署，掘金上发布了一篇文章。</p>
<p>js 这边没什么动静，只是最近做了一个公司的 todo，写了一篇关于代码健壮性的博客。</p>
<p>vue：</p>
<ul>
<li>重新上官网了解了 vue3 的新特性：<a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/migration/introduction.html#%E6%A6%82%E8%A7%88">Vue</a></li>
<li>阅读了《Vue.js设计与实现》的模板编译部分</li>
</ul>
<p>脚手架读了一篇搭建脚手架的博客：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6966119324478079007">从 0 构建自己的脚手架&#x2F;CLI知识体系（万字）</a>，并跟着后面做了一下。</p>
<p>构建工具方面：</p>
<ul>
<li>读了一篇文章了解了 webpack 的常见实用方法：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7023242274876162084">🔥【万字】透过分析 webpack 面试题，构建 webpack5.x 知识体系</a></li>
<li>读了一篇手写webpack原理的文章：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6854573217336541192">手写webpack核心原理，再也不怕面试官问我webpack原理</a></li>
<li>阅读了 vite 的官方文档，大致了解了一下 vite 的新特性</li>
</ul>
<p>最后谈一谈自己最近的感受吧。</p>
<p>首先，发现自己不能再和原来一样专门花一整块时间去学习一些比较难啃的东西，比如说阅读书籍，几个星期都读不完一本书，最后就半途而废。其次，有一点不知道自己到底要干什么的状态，有一种这里看一下那里看一下的感觉，感觉学到了一些东西，但是又好像没学到。自我分析一下，出现上述情况首先是因为没弄清楚前端到底该如何提升自己。应该明确两点：</p>
<p>第一，做好业务，是技术价值的体现，现在常见的开发如 web开发（Vue、React）、小程序（各式各样的小程序）、跨端开发（安卓、ios）等。当需求给到自己时，要知道如何去实现，是否可以优化，用户体验上如何。</p>
<p>第二，做好技术上的事情，这里其实也是用技术服务他人，只不过这里服务的对象从客户变成了开发者。比如项目搭建的脚手架、开发的框架、一些业务流程上的工具（CI&#x2F;CD、业务监控）、开发过程中使用的组件库、构建工具等技术产物，都是为了帮助开发者提高开发效率。</p>
<p>明白了这两点，那么自己的学习方向也应该分为两个方向。</p>
<p>首先，完成公司的业务需求，如果决定公司的项目不够挑战性，可以自己开发一些有意思的产品并不断的去打磨和维护。在这个过程中会遇到很多的问题，比如 js 代码写的是否够优雅、性能是否最优、一些常见的功能如何去实现等，我们的开发经验在这时不断的积累，努力的从一个菜鸟变成前端职场上的老油条。</p>
<p>其次，想做一个优秀的前端工程师，只会熟练的搬砖是不够的，需要在技术上有一定的沉淀。自己最近也是迷失在其中，又或者是说很多东西都不了解，去大致的了解了一下。这里给自己定下一个目标，专心去深耕一个领域，这里学一下那里学一下只能提高自己的视野，并不能让自己变得更强。当然我的意思不是说不要去了解和自己无关的事情，而是说大部分精力应该放在自己专注的事物上。</p>
<p>最后总结</p>
<ul>
<li>近段时间专注领域：Vue3 原理学习，阅读完《Vue.js设计与实现》，做好笔记，并阅读 vue3 源码。</li>
<li>近段时间感兴趣内容学习：<ul>
<li>js 代码质量（作为基础知识，在自己的任何阶段都应该持续学习）：读书 + 博客沉淀</li>
<li>浏览器：涉及到 v8 和构建工具，因此作为这一阶段的学习方向</li>
<li>构建工具：webpack、vite有时间学习基础用法，等vue3原理了解完后再学习这一部分的原理</li>
</ul>
</li>
</ul>
<h2 id="3-30"><a href="#3-30" class="headerlink" title="3.30"></a>3.30</h2><p>人生道路漫漫，切忌浮躁。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2Vue3%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2Vue3%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE/" class="post-title-link" itemprop="url">自动化部署Vue3博客项目</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-16 21:53:09" itemprop="dateCreated datePublished" datetime="2022-03-16T21:53:09+08:00">2022-03-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:46:04" itemprop="dateModified" datetime="2023-05-07T17:46:04+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近在开发自己的博客系统，每次迭代完一次代码就要重新手动部署一次，有时候部署后才发现一些bug，又要回过头来重新部署，十分的麻烦。自己的项目托管在github上，因此想实现每次push完代码到master分支上后，github可以自动的帮我进行部署这一步骤，这样就可以避免频繁的手动部署。</p>
<h2 id="0-我的博客"><a href="#0-我的博客" class="headerlink" title="0 我的博客"></a>0 我的博客</h2><p>线上地址：<a target="_blank" rel="noopener" href="http://travel.wutortoise.cn/">wk-blog</a></p>
<p>github 地址：<a target="_blank" rel="noopener" href="https://github.com/wk-Nemo/wk-blog">项目 github</a></p>
<p>项目简介：项目采用的是前后端分离的模式，前端的主要技术框架是 Vue3，后端使用的是 express</p>
<p>博客预览：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d7dd082a5294115becfb1df7e6e370f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h2 id="1-Github-Actions-简介"><a href="#1-Github-Actions-简介" class="headerlink" title="1 Github Actions 简介"></a>1 Github Actions 简介</h2><blockquote>
<p>参考文章：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/433426848">GitHub Actions自动化部署前端项目指南</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7003278731171069982">使用Github Actions来实现项目的CI&#x2F;CD</a></li>
</ul>
</blockquote>
<p>在我们前端常规的开发流程中，每次向远程分支推送完本次代码后，接下来进行的就是<strong>打包生成静态资源</strong>，再<strong>推送至服务器</strong>。这些步骤的特点就是在不同的项目中是类似的，且需要反复重复这些步骤。有没有一种方法可以在每次push完代码后，自动的去执行这些重复的动作呢？Giuthub Actions 就很好的解决了这一个问题。</p>
<p>GitHub Actions 是 GitHub 推出的一款持续集成（CI&#x2F;CD）服务，它给我们提供了虚拟的服务器资源，让我们可以基于它完成自动化测试、集成、部署等操作，Github 把这些操作称作 actions。如果我们需要在push完代码后执行某一个action，我们可以直接引用他人写好的 action 即可。</p>
<p>官方文档传送门：<a target="_blank" rel="noopener" href="https://docs.github.com/cn/actions">Github Actions</a></p>
<h3 id="1-1-基本概念"><a href="#1-1-基本概念" class="headerlink" title="1.1 基本概念"></a>1.1 基本概念</h3><p><strong>workflow</strong> （工作流程）：持续集成一次运行的过程，就是一个 workflow。</p>
<ul>
<li>name：工作流程的名称</li>
<li>on：触发工作流程的事件名称</li>
</ul>
<p><strong>job</strong> （任务）：一个 workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务。</p>
<ul>
<li><p>runs-on：任务运行的虚拟环境</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 目前可用的环境</span><br><span class="line">Windows Server 2019     windows-latest 或 windows-2019</span><br><span class="line">Ubuntu 20.04            ubuntu-20.04</span><br><span class="line">Ubuntu 18.04            ubuntu-latest 或 ubuntu-18.04</span><br><span class="line">Ubuntu 16.04            ubuntu-16.04</span><br><span class="line">macOS Catalina 10.15    macos-latest 或 macos-10.15</span><br><span class="line"></span><br><span class="line"># 使用</span><br><span class="line">runs-on: ubuntu-latest</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>step</strong>（步骤）：每个 job 由多个 step 构成，一步步完成。</p>
<ul>
<li>name：步骤名称</li>
<li>run：该步骤的命令或 action</li>
<li>env：所需要的环境变量</li>
<li>uses：选择任务步骤中一部分运行的操作。其实就是步骤使用的<code>actions</code>，可以是一个或多个</li>
</ul>
<p><strong>action</strong> （动作）：每个 step 可以依次执行一个或多个命令（action）。因为很多操作在不同项目中都是类似的，所以 GitHub 把 action 设计为一个独立的脚本文件，可以存放到代码仓库里，让其他开发者使用。所以在实际的使用中，可以直接使用别人写好的 action 而不必所有的都自己写。GitHub也为此做了一个<a target="_blank" rel="noopener" href="https://github.com/marketplace?type=actions">marketplace</a>，这里就是action的官方市场。</p>
<h2 id="2-Github-Actions-小实验"><a href="#2-Github-Actions-小实验" class="headerlink" title="2 Github Actions 小实验"></a>2 Github Actions 小实验</h2><blockquote>
<p>实验代码：<a target="_blank" rel="noopener" href="https://github.com/wk-Nemo/CI-CD">CI-CD</a></p>
</blockquote>
<p>本次实验的目的是实现 vue 项目的自动化部署。当我们本地开发完项目向远程分支推送代码时，GitHub会帮我们自动构建，生成静态资源，并部署到远程服务器上。</p>
<p>实验大致分以下几个步骤：</p>
<ul>
<li>准备好服务环境</li>
<li>创建 github 项目并创建 workflow</li>
<li>拉取 github 仓库，并新建一个 vue 项目，本地 push 代码</li>
<li>查看自动化部署是否完成</li>
</ul>
<h3 id="step1-服务环境准备"><a href="#step1-服务环境准备" class="headerlink" title="step1 服务环境准备"></a>step1 服务环境准备</h3><p>这里我使用的是阿里云的轻量服务器，服务器使用的操作系统是 ubuntu-20.04。</p>
<p>这里你可以使用自己的服务器，<strong>安装的操作系统自己也要记住</strong>，因为在后面我们会使用到。我们进入自己的服务器，并使用 Linux 命令创建好存放静态资源的文件夹，你可以选择自己常用的文件夹，但是<strong>需要记住这个路径</strong>，后面会使用到。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 这个文件夹是我部署项目的地方，你可以选择自己常用的文件夹，但是需要记住这个路径，后面会使用到</span><br><span class="line">cd /www</span><br><span class="line">sudo mkdir actionTest</span><br></pre></td></tr></table></figure>

<h3 id="step2-创建-github-项目"><a href="#step2-创建-github-项目" class="headerlink" title="step2 创建 github 项目"></a>step2 创建 github 项目</h3><p>在 github 上新建一个项目，这很 easy，不多赘述。</p>
<p>因为需要连接远程服务器，在创建 workflow 之前，我们需要创建一些需要使用的<strong>暗号</strong>。这个暗号就是一个<strong>变量名</strong>，然后它的值只有你和 Github 知道是什么，在需要使用的地方使用这个变量名，Github便能领会到这是一个私密的信息，并在执行流程时使用它<strong>真正的值</strong>去代替变量名。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c6eaa6fac4e4f0bac39a242bf4f09cb~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>按照上面的顺序我们便可以创建暗号了。我们以此建立三个暗号，他们的变量名分别是：</p>
<ul>
<li>DR_HOST：你的服务器IP地址</li>
<li>DR_USER：你的服务器账号，一般是 root</li>
<li>DR_PASS：你的 SSH 登录密码</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c548432ddf54f2a89af38cc5acb310b~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>准备好上面的内容我们就可以创建一个 workflow 了</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8f71fcd268034f4bb594ae29fade60e9~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8ba9f8b9f47e44b5bbc4313e9bb5e2b9~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>最后我们能看到如下的界面：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d72099cab904324970f10a81564246b~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>我们将里面的代码删除，并换成下面的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">name: build</span><br><span class="line">on: </span><br><span class="line">  push: </span><br><span class="line">    branches: </span><br><span class="line">      - main # 这里表示push到main分支就会触发流程</span><br><span class="line">jobs:</span><br><span class="line">  build-and-deploy:</span><br><span class="line">    runs-on: ubuntu-20.04</span><br><span class="line">    steps:</span><br><span class="line">      # 这是github官方的一个action，用于clone该仓库的源码到工作流中，</span><br><span class="line">      - name: Checkout 🛎️</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          persist-credentials: false</span><br><span class="line"></span><br><span class="line">      - name: Build</span><br><span class="line">        run: |</span><br><span class="line">          cd my-project # 进入项目目录</span><br><span class="line">          npm install  # 安装依赖</span><br><span class="line">          npm run build  # 执行打包</span><br><span class="line">  </span><br><span class="line">      # 连接到ssh，并且做一个拷贝操作的action</span><br><span class="line">      - name: Deploy 🚀</span><br><span class="line">        uses: cross-the-world/scp-pipeline@master</span><br><span class="line">        env:</span><br><span class="line">          WELCOME: &quot;ssh scp ssh pipelines&quot;</span><br><span class="line">          LASTSSH: &quot;Doing something after copying&quot;</span><br><span class="line">        with:</span><br><span class="line">         host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class="line">         user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class="line">         pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class="line">         connect_timeout: 10s</span><br><span class="line">         local: &#x27;./my-project/dist/*&#x27; # 这里是下一步要创建的vue项目构建完成后的静态资源路径</span><br><span class="line">         remote: /www/actionTest # 这里是 step1 中，在服务器上创建用于存放静态资源的文件夹</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后我们提交这部分代码,这里相当于在github仓库创建了一个 <code>/.github/workflows/build.yml</code> 的文件</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/154ed8ae17d04705b73d66190c067ddf~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>这里我们相当于提交了一次代码到 main 分支上，因此会执行流程，但因为我们还没有创建 vue 项目，因此流程不会执行成功。我们接着进行下一步。</p>
<h3 id="step3-本地开发"><a href="#step3-本地开发" class="headerlink" title="step3 本地开发"></a>step3 本地开发</h3><blockquote>
<p>Vue脚手架官网传送地址：<a target="_blank" rel="noopener" href="https://cli.vuejs.org/">Vue CLI</a></p>
</blockquote>
<p>接着我们拉取远程分支的代码，并使用 vue-cli 创建一个 vue 项目，最后再提交代码到 main 分支上。</p>
<h3 id="step4-验证实验结果"><a href="#step4-验证实验结果" class="headerlink" title="step4 验证实验结果"></a>step4 验证实验结果</h3><p>在 github 中的 action 中可以查看到工作流程正常执行</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5877fc69c0624946b9cd8eb04e14b27f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>点进去也可以看到核心的 build 和 deploy 也正常执行了</p>
<ul>
<li><p>正常构建<br>  <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f75de66214ad478393acedce96ce0268~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
</li>
<li><p>正常部署<br>  <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04f6dbf583164909811ed1d9db6c07da~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
</li>
</ul>
<p>我们再上服务器进行验证，可以发现 vue 项目打包后的 dist 中的内容正常部署到了我们服务器的目标文件夹中</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/967828d16050447b8c06d0949bf72e1f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h2 id="3-博客项目部署踩坑日记"><a href="#3-博客项目部署踩坑日记" class="headerlink" title="3 博客项目部署踩坑日记"></a>3 博客项目部署踩坑日记</h2><p>在开头已经介绍过我的博客项目，前端使用的是 vue3，具体的部署和上述实验差不多。但是中间在执行 npm install 时遇到了问题，最后通过指定 node 版本解决了问题。代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">name: frontend-build</span><br><span class="line">on: </span><br><span class="line">  push: </span><br><span class="line">    branches: </span><br><span class="line">      - main</span><br><span class="line">jobs:</span><br><span class="line">  build-and-deploy:</span><br><span class="line">    runs-on: ubuntu-20.04</span><br><span class="line">    steps:</span><br><span class="line">      - name: Checkout 🛎️</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          persist-credentials: false</span><br><span class="line">      </span><br><span class="line">      # 指定 node 版本</span><br><span class="line">      - uses: actions/setup-node@v2 </span><br><span class="line">        with:</span><br><span class="line">          node-version: &#x27;14&#x27;</span><br><span class="line"></span><br><span class="line">      - name: Build</span><br><span class="line">        run: |</span><br><span class="line">          cd blog-frontend # 进入项目目录</span><br><span class="line">          npm install  # 安装依赖</span><br><span class="line">          npm run build  # 执行打包</span><br><span class="line">  </span><br><span class="line">      - name: Deploy 🚀</span><br><span class="line">        uses: cross-the-world/scp-pipeline@master</span><br><span class="line">        env:</span><br><span class="line">          WELCOME: &quot;ssh scp ssh pipelines&quot;</span><br><span class="line">          LASTSSH: &quot;Doing something after copying&quot;</span><br><span class="line">        with:</span><br><span class="line">         host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class="line">         user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class="line">         pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class="line">         connect_timeout: 10s</span><br><span class="line">         local: &#x27;./blog-frontend/dist/*&#x27;</span><br><span class="line">         remote: /www/wk-blog/dist</span><br><span class="line">         last_ssh: |</span><br><span class="line">            nginx -s reload # 部署成功后需要重启nginx</span><br><span class="line">           </span><br></pre></td></tr></table></figure>

<p>后端代码使用的是 express，服务器上使用 pm2 开启项目。因为数据库中的博客信息是通过 js 脚本解析的，因此最后还需要执行脚本重新解析所有的博客文件，当上传新的博客时会更新数据库中的信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">name: backend-build</span><br><span class="line">on: </span><br><span class="line">  push: </span><br><span class="line">    branches: </span><br><span class="line">      - main</span><br><span class="line">jobs:</span><br><span class="line">  backend:</span><br><span class="line">    runs-on: ubuntu-20.04</span><br><span class="line">    steps:</span><br><span class="line">      - name: Checkout 🛎️</span><br><span class="line">        uses: actions/checkout@v2</span><br><span class="line">        with:</span><br><span class="line">          persist-credentials: false</span><br><span class="line">          </span><br><span class="line">      - uses: actions/setup-node@v2</span><br><span class="line">        with:</span><br><span class="line">          node-version: &#x27;14&#x27;</span><br><span class="line">  </span><br><span class="line">      - name: Deploy 🚀</span><br><span class="line">        uses: cross-the-world/scp-pipeline@master</span><br><span class="line">        env:</span><br><span class="line">          WELCOME: &quot;ssh scp ssh pipelines&quot;</span><br><span class="line">          LASTSSH: &quot;Doing something after copying&quot;</span><br><span class="line">        with:</span><br><span class="line">         host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class="line">         user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class="line">         pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class="line">         connect_timeout: 10s</span><br><span class="line">         local: &#x27;./express-backend/*&#x27;</span><br><span class="line">         remote: /www/wk-blog/backend</span><br><span class="line">         </span><br><span class="line">      - name: ssh pipelines - npm install</span><br><span class="line">        uses: cross-the-world/ssh-pipeline@master</span><br><span class="line">        env:</span><br><span class="line">          WELCOME: &quot;ssh pipeline&quot;</span><br><span class="line">        with:</span><br><span class="line">          host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class="line">          user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class="line">          pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class="line">          connect_timeout: 10s</span><br><span class="line">          script: |</span><br><span class="line">            cd /www/wk-blog/backend</span><br><span class="line">            npm install</span><br><span class="line">      </span><br><span class="line">      - name: ssh pipelines - read blogs</span><br><span class="line">        uses: cross-the-world/ssh-pipeline@master</span><br><span class="line">        env:</span><br><span class="line">          WELCOME: &quot;ssh pipeline&quot;</span><br><span class="line">        with:</span><br><span class="line">          host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class="line">          user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class="line">          pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class="line">          connect_timeout: 10s</span><br><span class="line">          script: |</span><br><span class="line">            cd /www/wk-blog/backend</span><br><span class="line">            node parse.js</span><br><span class="line">            </span><br><span class="line">      - name: ssh pipelines - restart www</span><br><span class="line">        uses: cross-the-world/ssh-pipeline@master</span><br><span class="line">        env:</span><br><span class="line">          WELCOME: &quot;ssh pipeline&quot;</span><br><span class="line">        with:</span><br><span class="line">          host: $&#123;&#123; secrets.DR_HOST &#125;&#125;</span><br><span class="line">          user: $&#123;&#123; secrets.DR_USER &#125;&#125;</span><br><span class="line">          pass: $&#123;&#123; secrets.DR_PASS &#125;&#125;</span><br><span class="line">          connect_timeout: 10s</span><br><span class="line">          script: |</span><br><span class="line">            cd bin</span><br><span class="line">            pm2 restart www</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/25/vue%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%EF%BC%88%E4%B8%80%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/25/vue%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%EF%BC%88%E4%B8%80%EF%BC%89/" class="post-title-link" itemprop="url">vue源码阅读—入口流程</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-25 22:34:18" itemprop="dateCreated datePublished" datetime="2021-11-25T22:34:18+08:00">2021-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:49:56" itemprop="dateModified" datetime="2023-05-07T17:49:56+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="从一个demo开始"><a href="#从一个demo开始" class="headerlink" title="从一个demo开始"></a>从一个demo开始</h2><p>今天开始阅读vue源码，首先写一个简单的demo进行debugger摸清楚整个初始化的流程。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123;a&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">debugger</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">a</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="new-Vue"><a href="#new-Vue" class="headerlink" title="new Vue"></a>new Vue</h2><p><code>new Vue</code>执行的是在<code>src/core/instance/index.js</code>中暴露出的<code>Vue</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; initMixin &#125; <span class="keyword">from</span> <span class="string">&#x27;./init&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; stateMixin &#125; <span class="keyword">from</span> <span class="string">&#x27;./state&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderMixin &#125; <span class="keyword">from</span> <span class="string">&#x27;./render&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; eventsMixin &#125; <span class="keyword">from</span> <span class="string">&#x27;./events&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; lifecycleMixin &#125; <span class="keyword">from</span> <span class="string">&#x27;./lifecycle&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; warn &#125; <span class="keyword">from</span> <span class="string">&#x27;../util/index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Vue</span> (options) &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp;</span><br><span class="line">    !(<span class="variable language_">this</span> <span class="keyword">instanceof</span> <span class="title class_">Vue</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="title function_">warn</span>(<span class="string">&#x27;Vue is a constructor and should be called with the `new` keyword&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">_init</span>(options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">initMixin</span>(<span class="title class_">Vue</span>)</span><br><span class="line"><span class="title function_">stateMixin</span>(<span class="title class_">Vue</span>)</span><br><span class="line"><span class="title function_">eventsMixin</span>(<span class="title class_">Vue</span>)</span><br><span class="line"><span class="title function_">lifecycleMixin</span>(<span class="title class_">Vue</span>)</span><br><span class="line"><span class="title function_">renderMixin</span>(<span class="title class_">Vue</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Vue</span></span><br></pre></td></tr></table></figure>

<p>接着会执行<code>this._init(options)</code>,<code>_init</code>是在<code>scr/core/instance/init.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initMixin</span> (<span class="title class_">Vue</span>: <span class="title class_">Class</span>&lt;<span class="title class_">Component</span>&gt;) &#123;</span><br><span class="line">  <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">_init</span> = <span class="keyword">function</span> (<span class="params">options?: <span class="built_in">Object</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">vm</span>: <span class="title class_">Component</span> = <span class="variable language_">this</span></span><br><span class="line">    <span class="comment">// a uid</span></span><br><span class="line">    vm.<span class="property">_uid</span> = uid++</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> startTag, endTag</span><br><span class="line">    <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">    <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; config.<span class="property">performance</span> &amp;&amp; mark) &#123;</span><br><span class="line">      startTag = <span class="string">`vue-perf-start:<span class="subst">$&#123;vm._uid&#125;</span>`</span></span><br><span class="line">      endTag = <span class="string">`vue-perf-end:<span class="subst">$&#123;vm._uid&#125;</span>`</span></span><br><span class="line">      <span class="title function_">mark</span>(startTag)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// a flag to avoid this being observed</span></span><br><span class="line">    vm.<span class="property">_isVue</span> = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// merge options</span></span><br><span class="line">    <span class="keyword">if</span> (options &amp;&amp; options.<span class="property">_isComponent</span>) &#123;</span><br><span class="line">      <span class="comment">// optimize internal component instantiation</span></span><br><span class="line">      <span class="comment">// since dynamic options merging is pretty slow, and none of the</span></span><br><span class="line">      <span class="comment">// internal component options needs special treatment.</span></span><br><span class="line">      <span class="title function_">initInternalComponent</span>(vm, options)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      vm.<span class="property">$options</span> = <span class="title function_">mergeOptions</span>(</span><br><span class="line">        <span class="title function_">resolveConstructorOptions</span>(vm.<span class="property">constructor</span>),</span><br><span class="line">        options || &#123;&#125;,</span><br><span class="line">        vm</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">    <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">      <span class="title function_">initProxy</span>(vm)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      vm.<span class="property">_renderProxy</span> = vm</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// expose real self</span></span><br><span class="line">    vm.<span class="property">_self</span> = vm</span><br><span class="line">    <span class="title function_">initLifecycle</span>(vm)</span><br><span class="line">    <span class="title function_">initEvents</span>(vm)</span><br><span class="line">    <span class="title function_">initRender</span>(vm)</span><br><span class="line">    <span class="title function_">callHook</span>(vm, <span class="string">&#x27;beforeCreate&#x27;</span>)</span><br><span class="line">    <span class="title function_">initInjections</span>(vm) <span class="comment">// resolve injections before data/props</span></span><br><span class="line">    <span class="title function_">initState</span>(vm)</span><br><span class="line">    <span class="title function_">initProvide</span>(vm) <span class="comment">// resolve provide after data/props</span></span><br><span class="line">    <span class="title function_">callHook</span>(vm, <span class="string">&#x27;created&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">    <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; config.<span class="property">performance</span> &amp;&amp; mark) &#123;</span><br><span class="line">      vm.<span class="property">_name</span> = <span class="title function_">formatComponentName</span>(vm, <span class="literal">false</span>)</span><br><span class="line">      <span class="title function_">mark</span>(endTag)</span><br><span class="line">      <span class="title function_">measure</span>(<span class="string">`vue <span class="subst">$&#123;vm._name&#125;</span> init`</span>, startTag, endTag)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vm.<span class="property">$options</span>.<span class="property">el</span>) &#123;</span><br><span class="line">      vm.$mount(vm.<span class="property">$options</span>.<span class="property">el</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码干了几件事情：</p>
<ul>
<li>定义了一个<code>vm</code>，初始化的值为我们<code>new Vue</code>时传入的参数，并在这个对象加入了几个新的值如:<ul>
<li><code>_uid = 0</code></li>
<li><code>_isVue = true</code> </li>
<li><code>$options = mergeOptions(resolveConstructorOptions(vm.constructor), options || &#123;&#125;, vm)</code></li>
<li><code>vm._self = vm</code></li>
</ul>
</li>
<li>一系列的初始化<ul>
<li><code>initLifecycle(vm)</code></li>
<li><code>initEvents(vm) </code></li>
<li><code>initRender(vm) </code></li>
<li><code>callHook(vm, &#39;beforeCreate&#39;)</code> </li>
<li><code>initInjections(vm) </code></li>
<li><code>initState(vm)</code> </li>
<li><code>initProvide(vm) </code></li>
<li><code>callHook(vm, &#39;created&#39;)</code></li>
</ul>
</li>
<li><code>vm.$mount(vm.$options.el)</code> 进行挂载</li>
</ul>
<h2 id="给vm添加-option"><a href="#给vm添加-option" class="headerlink" title="给vm添加$option"></a>给<code>vm</code>添加<code>$option</code></h2><p>本来我没在意<code>$option</code>这个参数，但是在后面的阅读中，发现很多参数是在<code>$option</code>中取出来的，因此特地花一个小节来看看<code>mergeOptions</code>函数做了啥。</p>
<p><code>mergeOption</code>函数定义在<code>src/core/util/options.js</code>中</p>
<ul>
<li>还没看详细的代码，从定义的位置可以猜出这个函数是一个工具作用，专门用来<strong>合并选项</strong>。</li>
<li>本打算继续深入看函数是如何实现的，会不会新添加了什么选项到<code>option</code>，但看到函数的注释后可以清晰的理解它只是合并两个<code>option</code>。因此我没必要关系它是如何实现的，而应该关心调用它的地方到底合并了哪两个<code>option</code>.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Merge two option objects into a new one.</span></span><br><span class="line"><span class="comment"> * Core utility used in both instantiation and inheritance.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">mergeOptions</span> (</span><br><span class="line">  <span class="attr">parent</span>: <span class="title class_">Object</span>,</span><br><span class="line">  <span class="attr">child</span>: <span class="title class_">Object</span>,</span><br><span class="line">  vm?: <span class="title class_">Component</span></span><br><span class="line">): <span class="title class_">Object</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">checkComponents</span>(child)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> child === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    child = child.<span class="property">options</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">normalizeProps</span>(child, vm)</span><br><span class="line">  <span class="title function_">normalizeInject</span>(child, vm)</span><br><span class="line">  <span class="title function_">normalizeDirectives</span>(child)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Apply extends and mixins on the child options,</span></span><br><span class="line">  <span class="comment">// but only if it is a raw options object that isn&#x27;t</span></span><br><span class="line">  <span class="comment">// the result of another mergeOptions call.</span></span><br><span class="line">  <span class="comment">// Only merged options has the _base property.</span></span><br><span class="line">  <span class="keyword">if</span> (!child.<span class="property">_base</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (child.<span class="property">extends</span>) &#123;</span><br><span class="line">      parent = <span class="title function_">mergeOptions</span>(parent, child.<span class="property">extends</span>, vm)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (child.<span class="property">mixins</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l = child.<span class="property">mixins</span>.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">        parent = <span class="title function_">mergeOptions</span>(parent, child.<span class="property">mixins</span>[i], vm)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> options = &#123;&#125;</span><br><span class="line">  <span class="keyword">let</span> key</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> parent) &#123;</span><br><span class="line">    <span class="title function_">mergeField</span>(key)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> child) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">hasOwn</span>(parent, key)) &#123;</span><br><span class="line">      <span class="title function_">mergeField</span>(key)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">mergeField</span> (key) &#123;</span><br><span class="line">    <span class="keyword">const</span> strat = strats[key] || defaultStrat</span><br><span class="line">    options[key] = <span class="title function_">strat</span>(parent[key], child[key], vm, key)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> options</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们回到参数这里，在<code>_init</code>中调用<code>mergeOption</code>时传入了三个参数：</p>
<ul>
<li><code>resolveConstructorOptions(vm.constructor)</code></li>
<li><code>options || &#123;&#125;</code>，我们<code>new Vue</code>时传入的参数</li>
<li><code>vm</code></li>
</ul>
<p>最后我们可以在控制台打印<code>vm</code>看看此时该对象内部有哪些内容</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/facfa86a896043fb91d71b7458402bdf~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h2 id="一系列的初始化"><a href="#一系列的初始化" class="headerlink" title="一系列的初始化"></a>一系列的初始化</h2><p>上面我们弄清楚了在一系列的操作后<code>vm</code>里面有了哪些东西，接下来我们就要看看一系列的初始化到底干了啥。</p>
<ul>
<li><code>initLifecycle(vm)</code></li>
<li><code>initEvents(vm) </code></li>
<li><code>initRender(vm) </code></li>
<li><code>callHook(vm, &#39;beforeCreate&#39;)</code> </li>
<li><code>initInjections(vm) </code></li>
<li><code>initState(vm)</code> </li>
<li><code>initProvide(vm) </code></li>
<li><code>callHook(vm, &#39;created&#39;)</code></li>
</ul>
<p>一、<code>initLifecycle(vm)</code>给<code>vm</code>上添加了很多的<code>$xxx</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initLifecycle</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> options = vm.<span class="property">$options</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// locate first non-abstract parent</span></span><br><span class="line">  <span class="keyword">let</span> parent = options.<span class="property">parent</span></span><br><span class="line">  <span class="keyword">if</span> (parent &amp;&amp; !options.<span class="property">abstract</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> (parent.<span class="property">$options</span>.<span class="property">abstract</span> &amp;&amp; parent.<span class="property">$parent</span>) &#123;</span><br><span class="line">      parent = parent.<span class="property">$parent</span></span><br><span class="line">    &#125;</span><br><span class="line">    parent.<span class="property">$children</span>.<span class="title function_">push</span>(vm)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  vm.<span class="property">$parent</span> = parent</span><br><span class="line">  vm.<span class="property">$root</span> = parent ? parent.<span class="property">$root</span> : vm</span><br><span class="line"></span><br><span class="line">  vm.<span class="property">$children</span> = []</span><br><span class="line">  vm.<span class="property">$refs</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  vm.<span class="property">_watcher</span> = <span class="literal">null</span></span><br><span class="line">  vm.<span class="property">_inactive</span> = <span class="literal">null</span></span><br><span class="line">  vm.<span class="property">_directInactive</span> = <span class="literal">false</span></span><br><span class="line">  vm.<span class="property">_isMounted</span> = <span class="literal">false</span></span><br><span class="line">  vm.<span class="property">_isDestroyed</span> = <span class="literal">false</span></span><br><span class="line">  vm.<span class="property">_isBeingDestroyed</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二、<code>initEvents(vm) </code>初始化也只给<code>vm</code>是添加了<code>_events</code>和<code>_hasHookEvent</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initEvents</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>) &#123;</span><br><span class="line">  vm.<span class="property">_events</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>)</span><br><span class="line">  vm.<span class="property">_hasHookEvent</span> = <span class="literal">false</span></span><br><span class="line">  <span class="comment">// init parent attached events</span></span><br><span class="line">  <span class="keyword">const</span> listeners = vm.<span class="property">$options</span>.<span class="property">_parentListeners</span></span><br><span class="line">  <span class="keyword">if</span> (listeners) &#123;</span><br><span class="line">    <span class="title function_">updateComponentListeners</span>(vm, listeners)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>三、<code>initRender(vm) </code>上半段同上面一样，添加了一些内容在<code>vm</code>上</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initRender</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>) &#123;</span><br><span class="line">  vm.<span class="property">_vnode</span> = <span class="literal">null</span> <span class="comment">// the root of the child tree</span></span><br><span class="line">  vm.<span class="property">_staticTrees</span> = <span class="literal">null</span> <span class="comment">// v-once cached trees</span></span><br><span class="line">  <span class="keyword">const</span> options = vm.<span class="property">$options</span></span><br><span class="line">  <span class="keyword">const</span> parentVnode = vm.<span class="property">$vnode</span> = options.<span class="property">_parentVnode</span> <span class="comment">// the placeholder node in parent tree</span></span><br><span class="line">  <span class="keyword">const</span> renderContext = parentVnode &amp;&amp; parentVnode.<span class="property">context</span></span><br><span class="line">  vm.<span class="property">$slots</span> = <span class="title function_">resolveSlots</span>(options.<span class="property">_renderChildren</span>, renderContext)</span><br><span class="line">  vm.<span class="property">$scopedSlots</span> = emptyObject</span><br><span class="line">  <span class="comment">// bind the createElement fn to this instance</span></span><br><span class="line">  <span class="comment">// so that we get proper render context inside it.</span></span><br><span class="line">  <span class="comment">// args order: tag, data, children, normalizationType, alwaysNormalize</span></span><br><span class="line">  <span class="comment">// internal version is used by render functions compiled from templates</span></span><br><span class="line">  vm.<span class="property">_c</span> = <span class="function">(<span class="params">a, b, c, d</span>) =&gt;</span> <span class="title function_">createElement</span>(vm, a, b, c, d, <span class="literal">false</span>)</span><br><span class="line">  <span class="comment">// normalization is always applied for the public version, used in</span></span><br><span class="line">  <span class="comment">// user-written render functions.</span></span><br><span class="line">  vm.<span class="property">$createElement</span> = <span class="function">(<span class="params">a, b, c, d</span>) =&gt;</span> <span class="title function_">createElement</span>(vm, a, b, c, d, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// $attrs &amp; $listeners are exposed for easier HOC creation.</span></span><br><span class="line">  <span class="comment">// they need to be reactive so that HOCs using them are always updated</span></span><br><span class="line">  <span class="keyword">const</span> parentData = parentVnode &amp;&amp; parentVnode.<span class="property">data</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">defineReactive</span>(vm, <span class="string">&#x27;$attrs&#x27;</span>, parentData &amp;&amp; parentData.<span class="property">attrs</span> || emptyObject, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      !isUpdatingChildComponent &amp;&amp; <span class="title function_">warn</span>(<span class="string">`$attrs is readonly.`</span>, vm)</span><br><span class="line">    &#125;, <span class="literal">true</span>)</span><br><span class="line">    <span class="title function_">defineReactive</span>(vm, <span class="string">&#x27;$listeners&#x27;</span>, options.<span class="property">_parentListeners</span> || emptyObject, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      !isUpdatingChildComponent &amp;&amp; <span class="title function_">warn</span>(<span class="string">`$listeners is readonly.`</span>, vm)</span><br><span class="line">    &#125;, <span class="literal">true</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">defineReactive</span>(vm, <span class="string">&#x27;$attrs&#x27;</span>, parentData &amp;&amp; parentData.<span class="property">attrs</span> || emptyObject, <span class="literal">null</span>, <span class="literal">true</span>)</span><br><span class="line">    <span class="title function_">defineReactive</span>(vm, <span class="string">&#x27;$listeners&#x27;</span>, options.<span class="property">_parentListeners</span> || emptyObject, <span class="literal">null</span>, <span class="literal">true</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意到后面最后一步时<code>defineReactive</code>函数大有乾坤，该函数的位置在<code>src/core/observer/index.js</code>。如果你之前了解了vue的数据双向绑定的原理，那么对这段代码你一定不会陌生，他是对对象进行了处理，为数据的双向绑定做了铺垫。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Define a reactive property on an Object.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">defineReactive</span> (</span><br><span class="line">  <span class="attr">obj</span>: <span class="title class_">Object</span>,</span><br><span class="line">  <span class="attr">key</span>: string,</span><br><span class="line">  <span class="attr">val</span>: any,</span><br><span class="line">  customSetter?: ?<span class="title class_">Function</span>,</span><br><span class="line">  shallow?: boolean</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">const</span> dep = <span class="keyword">new</span> <span class="title class_">Dep</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> property = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, key)</span><br><span class="line">  <span class="keyword">if</span> (property &amp;&amp; property.<span class="property">configurable</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// cater for pre-defined getter/setters</span></span><br><span class="line">  <span class="keyword">const</span> getter = property &amp;&amp; property.<span class="property">get</span></span><br><span class="line">  <span class="keyword">const</span> setter = property &amp;&amp; property.<span class="property">set</span></span><br><span class="line">  <span class="keyword">if</span> ((!getter || setter) &amp;&amp; <span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">    val = obj[key]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> childOb = !shallow &amp;&amp; <span class="title function_">observe</span>(val)</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, &#123;</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">reactiveGetter</span> () &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Dep</span>.<span class="property">target</span>) &#123;</span><br><span class="line">        dep.<span class="title function_">depend</span>()</span><br><span class="line">        <span class="keyword">if</span> (childOb) &#123;</span><br><span class="line">          childOb.<span class="property">dep</span>.<span class="title function_">depend</span>()</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line">            <span class="title function_">dependArray</span>(value)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="keyword">function</span> <span class="title function_">reactiveSetter</span> (newVal) &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line">      <span class="comment">/* eslint-disable no-self-compare */</span></span><br><span class="line">      <span class="keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* eslint-enable no-self-compare */</span></span><br><span class="line">      <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; customSetter) &#123;</span><br><span class="line">        <span class="title function_">customSetter</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// #7981: for accessor properties without setter</span></span><br><span class="line">      <span class="keyword">if</span> (getter &amp;&amp; !setter) <span class="keyword">return</span></span><br><span class="line">      <span class="keyword">if</span> (setter) &#123;</span><br><span class="line">        setter.<span class="title function_">call</span>(obj, newVal)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val = newVal</span><br><span class="line">      &#125;</span><br><span class="line">      childOb = !shallow &amp;&amp; <span class="title function_">observe</span>(newVal)</span><br><span class="line">      dep.<span class="title function_">notify</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>四、看到这一串代码最瞩目的就是<code>callHook(vm, &#39;beforeCreate&#39;)</code>和<code>callHook(vm, &#39;created&#39;)</code>，很自然而然的就可以将它和生命周期联想到一起。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">callHook</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>, <span class="attr">hook</span>: string) &#123;</span><br><span class="line">  <span class="comment">// #7573 disable dep collection when invoking lifecycle hooks</span></span><br><span class="line">  <span class="title function_">pushTarget</span>()</span><br><span class="line">  <span class="keyword">const</span> handlers = vm.<span class="property">$options</span>[hook]</span><br><span class="line">  <span class="keyword">const</span> info = <span class="string">`<span class="subst">$&#123;hook&#125;</span> hook`</span></span><br><span class="line">  <span class="keyword">if</span> (handlers) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, j = handlers.<span class="property">length</span>; i &lt; j; i++) &#123;</span><br><span class="line">      <span class="title function_">invokeWithErrorHandling</span>(handlers[i], vm, <span class="literal">null</span>, vm, info)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (vm.<span class="property">_hasHookEvent</span>) &#123;</span><br><span class="line">    vm.$emit(<span class="string">&#x27;hook:&#x27;</span> + hook)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">popTarget</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>五、<code>initInjections(vm) </code>这里初始化的时候都是<code>undefined</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initInjections</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="title function_">resolveInject</span>(vm.<span class="property">$options</span>.<span class="property">inject</span>, vm)</span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="title function_">toggleObserving</span>(<span class="literal">false</span>)</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(result).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">      <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_">defineReactive</span>(vm, key, result[key], <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">warn</span>(</span><br><span class="line">            <span class="string">`Avoid mutating an injected value directly since the changes will be `</span> +</span><br><span class="line">            <span class="string">`overwritten whenever the provided component re-renders. `</span> +</span><br><span class="line">            <span class="string">`injection being mutated: &quot;<span class="subst">$&#123;key&#125;</span>&quot;`</span>,</span><br><span class="line">            vm</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">defineReactive</span>(vm, key, result[key])</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">toggleObserving</span>(<span class="literal">true</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>六、<code>initState(vm)</code> 这段代码比较直接，可以清楚的看到对<code>props</code>，<code>methods</code>和<code>data</code>进行了初始化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initState</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>) &#123;</span><br><span class="line">  vm.<span class="property">_watchers</span> = []</span><br><span class="line">  <span class="keyword">const</span> opts = vm.<span class="property">$options</span></span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">props</span>) <span class="title function_">initProps</span>(vm, opts.<span class="property">props</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">methods</span>) <span class="title function_">initMethods</span>(vm, opts.<span class="property">methods</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">data</span>) &#123;</span><br><span class="line">    <span class="title function_">initData</span>(vm)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">observe</span>(vm.<span class="property">_data</span> = &#123;&#125;, <span class="literal">true</span> <span class="comment">/* asRootData */</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">computed</span>) <span class="title function_">initComputed</span>(vm, opts.<span class="property">computed</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">watch</span> &amp;&amp; opts.<span class="property">watch</span> !== nativeWatch) &#123;</span><br><span class="line">    <span class="title function_">initWatch</span>(vm, opts.<span class="property">watch</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>七、<code>initProvide(vm) </code>略</p>
<h2 id="进行挂载"><a href="#进行挂载" class="headerlink" title="进行挂载"></a>进行挂载</h2><p>通过前面的代码阅读可知<code>_init</code>在前面对<code>vm</code>进行了很多的工作，到了<code>_init</code>的最后一步则执行<code>vm.$mount(vm.$options.el)</code>将实例挂载到<code>el</code>上。</p>
<p>因为 <code>$mount</code> 这个方法的实现是和平台、构建方式都相关的，我们重点来了解带 <code>compiler</code> 版本的 <code>$mount</code> 实现。它</p>
<ul>
<li>将原本<code>src/platform/web/runtime/index.js</code>的<code>$mount</code>缓存  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$mount</span> = <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">  el?: string | Element,</span></span><br><span class="line"><span class="params">  hydrating?: boolean</span></span><br><span class="line"><span class="params"></span>): <span class="title class_">Component</span> &#123;</span><br><span class="line">  el = el &amp;&amp; inBrowser ? <span class="title function_">query</span>(el) : <span class="literal">undefined</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">mountComponent</span>(<span class="variable language_">this</span>, el, hydrating)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>src/platform/web/entry-runtime-with-compiler.js</code> 文件中重新定义<code>$mount</code>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mount = <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$mount</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$mount</span> = <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">  el?: string | Element,</span></span><br><span class="line"><span class="params">  hydrating?: boolean</span></span><br><span class="line"><span class="params"></span>): <span class="title class_">Component</span> &#123;</span><br><span class="line">  el = el &amp;&amp; <span class="title function_">query</span>(el)</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">  <span class="keyword">if</span> (el === <span class="variable language_">document</span>.<span class="property">body</span> || el === <span class="variable language_">document</span>.<span class="property">documentElement</span>) &#123;</span><br><span class="line">    process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; <span class="title function_">warn</span>(</span><br><span class="line">      <span class="string">`Do not mount Vue to &lt;html&gt; or &lt;body&gt; - mount to normal elements instead.`</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> options = <span class="variable language_">this</span>.<span class="property">$options</span></span><br><span class="line">  <span class="comment">// resolve template/el and convert to render function</span></span><br><span class="line">  <span class="keyword">if</span> (!options.<span class="property">render</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> template = options.<span class="property">template</span></span><br><span class="line">    <span class="keyword">if</span> (template) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> template === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (template.<span class="title function_">charAt</span>(<span class="number">0</span>) === <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">          template = <span class="title function_">idToTemplate</span>(template)</span><br><span class="line">          <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">          <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; !template) &#123;</span><br><span class="line">            <span class="title function_">warn</span>(</span><br><span class="line">              <span class="string">`Template element not found or is empty: <span class="subst">$&#123;options.template&#125;</span>`</span>,</span><br><span class="line">              <span class="variable language_">this</span></span><br><span class="line">            )</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (template.<span class="property">nodeType</span>) &#123;</span><br><span class="line">        template = template.<span class="property">innerHTML</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">          <span class="title function_">warn</span>(<span class="string">&#x27;invalid template option:&#x27;</span> + template, <span class="variable language_">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el) &#123;</span><br><span class="line">      template = <span class="title function_">getOuterHTML</span>(el)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (template) &#123;</span><br><span class="line">      <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; config.<span class="property">performance</span> &amp;&amp; mark) &#123;</span><br><span class="line">        <span class="title function_">mark</span>(<span class="string">&#x27;compile&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> &#123; render, staticRenderFns &#125; = <span class="title function_">compileToFunctions</span>(template, &#123;</span><br><span class="line">        <span class="attr">outputSourceRange</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">        shouldDecodeNewlines,</span><br><span class="line">        shouldDecodeNewlinesForHref,</span><br><span class="line">        <span class="attr">delimiters</span>: options.<span class="property">delimiters</span>,</span><br><span class="line">        <span class="attr">comments</span>: options.<span class="property">comments</span></span><br><span class="line">      &#125;, <span class="variable language_">this</span>)</span><br><span class="line">      options.<span class="property">render</span> = render</span><br><span class="line">      options.<span class="property">staticRenderFns</span> = staticRenderFns</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; config.<span class="property">performance</span> &amp;&amp; mark) &#123;</span><br><span class="line">        <span class="title function_">mark</span>(<span class="string">&#x27;compile end&#x27;</span>)</span><br><span class="line">        <span class="title function_">measure</span>(<span class="string">`vue <span class="subst">$&#123;<span class="variable language_">this</span>._name&#125;</span> compile`</span>, <span class="string">&#x27;compile&#x27;</span>, <span class="string">&#x27;compile end&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> mount.<span class="title function_">call</span>(<span class="variable language_">this</span>, el, hydrating)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>最后再执行原本的<code>$mount</code>也就是执行了<code>mountComponent</code>方法</li>
</ul>
<p>我们来看看<code>mountComponent</code>方法干了什么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">mountComponent</span> (</span><br><span class="line">  <span class="attr">vm</span>: <span class="title class_">Component</span>,</span><br><span class="line">  <span class="attr">el</span>: ?<span class="title class_">Element</span>,</span><br><span class="line">  hydrating?: boolean</span><br><span class="line">): <span class="title class_">Component</span> &#123;</span><br><span class="line">  vm.<span class="property">$el</span> = el</span><br><span class="line">  <span class="keyword">if</span> (!vm.<span class="property">$options</span>.<span class="property">render</span>) &#123;</span><br><span class="line">    vm.<span class="property">$options</span>.<span class="property">render</span> = createEmptyVNode</span><br><span class="line">    <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="keyword">if</span> ((vm.<span class="property">$options</span>.<span class="property">template</span> &amp;&amp; vm.<span class="property">$options</span>.<span class="property">template</span>.<span class="title function_">charAt</span>(<span class="number">0</span>) !== <span class="string">&#x27;#&#x27;</span>) ||</span><br><span class="line">        vm.<span class="property">$options</span>.<span class="property">el</span> || el) &#123;</span><br><span class="line">        <span class="title function_">warn</span>(</span><br><span class="line">          <span class="string">&#x27;You are using the runtime-only build of Vue where the template &#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;compiler is not available. Either pre-compile the templates into &#x27;</span> +</span><br><span class="line">          <span class="string">&#x27;render functions, or use the compiler-included build.&#x27;</span>,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">warn</span>(</span><br><span class="line">          <span class="string">&#x27;Failed to mount component: template or render function not defined.&#x27;</span>,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">callHook</span>(vm, <span class="string">&#x27;beforeMount&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> updateComponent</span><br><span class="line">  <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; config.<span class="property">performance</span> &amp;&amp; mark) &#123;</span><br><span class="line">    updateComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> name = vm.<span class="property">_name</span></span><br><span class="line">      <span class="keyword">const</span> id = vm.<span class="property">_uid</span></span><br><span class="line">      <span class="keyword">const</span> startTag = <span class="string">`vue-perf-start:<span class="subst">$&#123;id&#125;</span>`</span></span><br><span class="line">      <span class="keyword">const</span> endTag = <span class="string">`vue-perf-end:<span class="subst">$&#123;id&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">      <span class="title function_">mark</span>(startTag)</span><br><span class="line">      <span class="keyword">const</span> vnode = vm.<span class="title function_">_render</span>()</span><br><span class="line">      <span class="title function_">mark</span>(endTag)</span><br><span class="line">      <span class="title function_">measure</span>(<span class="string">`vue <span class="subst">$&#123;name&#125;</span> render`</span>, startTag, endTag)</span><br><span class="line"></span><br><span class="line">      <span class="title function_">mark</span>(startTag)</span><br><span class="line">      vm.<span class="title function_">_update</span>(vnode, hydrating)</span><br><span class="line">      <span class="title function_">mark</span>(endTag)</span><br><span class="line">      <span class="title function_">measure</span>(<span class="string">`vue <span class="subst">$&#123;name&#125;</span> patch`</span>, startTag, endTag)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    updateComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      vm.<span class="title function_">_update</span>(vm.<span class="title function_">_render</span>(), hydrating)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// we set this to vm._watcher inside the watcher&#x27;s constructor</span></span><br><span class="line">  <span class="comment">// since the watcher&#x27;s initial patch may call $forceUpdate (e.g. inside child</span></span><br><span class="line">  <span class="comment">// component&#x27;s mounted hook), which relies on vm._watcher being already defined</span></span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Watcher</span>(vm, updateComponent, noop, &#123;</span><br><span class="line">    before () &#123;</span><br><span class="line">      <span class="keyword">if</span> (vm.<span class="property">_isMounted</span> &amp;&amp; !vm.<span class="property">_isDestroyed</span>) &#123;</span><br><span class="line">        <span class="title function_">callHook</span>(vm, <span class="string">&#x27;beforeUpdate&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="literal">true</span> <span class="comment">/* isRenderWatcher */</span>)</span><br><span class="line">  hydrating = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// manually mounted instance, call mounted on self</span></span><br><span class="line">  <span class="comment">// mounted is called for render-created child components in its inserted hook</span></span><br><span class="line">  <span class="keyword">if</span> (vm.<span class="property">$vnode</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">    vm.<span class="property">_isMounted</span> = <span class="literal">true</span></span><br><span class="line">    <span class="title function_">callHook</span>(vm, <span class="string">&#x27;mounted&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> vm</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实例化一个渲染<code>Watcher</code>，在它的回调函数中会调用 <code>updateComponent</code> 方法</li>
<li>在<code>updateComponent</code> 方法中调用 <code>vm._render</code> 方法先生成虚拟 Node</li>
<li>最终调用 <code>vm._update</code> 更新 DOM。</li>
</ul>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>读完这一段代码能感觉到在这个简单的小demo中，vue的工作始终都围绕着<strong>生命周期</strong>、<strong>数据双向绑定</strong>和<strong>模板编译</strong>这三块内容。后面进一步打算围绕这几个部分的实现阅读源码。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/13/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%A4%8D%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/13/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%A4%8D%E4%B9%A0/" class="post-title-link" itemprop="url">软件测试复习</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-13 11:29:04" itemprop="dateCreated datePublished" datetime="2021-11-13T11:29:04+08:00">2021-11-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:44:18" itemprop="dateModified" datetime="2023-05-07T17:44:18+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">计算机基础</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">测试</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="考试范围"><a href="#考试范围" class="headerlink" title="考试范围"></a>考试范围</h2><p>时间： 2021.11.14</p>
<p>题目类型：</p>
<ul>
<li>选择题 15</li>
<li>简答题 5-6</li>
<li>设计题：充分性、CFG 3-6</li>
<li>测试生成题</li>
</ul>
<p>考试内容：</p>
<ul>
<li>测试基本概念</li>
<li>测试生成方法（每个方法都涉及）</li>
<li>Junit</li>
<li>谓词分析</li>
<li>边界值</li>
<li>充分性和有效性</li>
<li>自动机</li>
</ul>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong>1. 为什么需要软件测试？</strong></p>
<ul>
<li>软件测试可以避免一些软件的漏洞</li>
<li>软件测试可以可以使我们的软件开发更可靠</li>
<li>软件测试可以使我们获得更高质量的软件</li>
</ul>
<p><strong>2. 关于软件测试的一些知识</strong></p>
<p><strong>（1）什么是缺陷（defect）？</strong></p>
<ul>
<li>缺点：运行缓慢。</li>
<li>不一致：Ctrl+S 无法保存所有应用程序。</li>
<li>用户界面设计缺陷：一个按钮上应该显示5个字，但只能看到3个字</li>
</ul>
<p>正确的程序：</p>
<ul>
<li>无语法错误</li>
<li>运行时无明显错误</li>
<li>无不当语句</li>
<li>有效输入-正确输出</li>
<li>无效输入-正确输出</li>
<li>任何可能的输入-正确输出</li>
</ul>
<p><strong>（2）软件质量（Software Quality）</strong></p>
<ul>
<li>满足用户需求</li>
<li>简历合理的进度、成本与功能关系</li>
<li>具备拓展性和灵活性</li>
<li>能有效处理例外情况</li>
<li>保持成本和性能平衡</li>
</ul>
<p><strong>（3）软件质量保证（Software Quality Assurance）</strong></p>
<p>为了确保软件开发过程和结果符合预期要求，而建立的一些列规程，依照规程和计划采取的一系列活动，以及结果评价。</p>
<p><strong>（4）质量监控（Quality Control）</strong></p>
<p>为达到产品的品质要求所采取的作业技术和活动</p>
<p><strong>3. 软件测试的基本概念</strong></p>
<p>（1）软件测试的定义<br>（2）验证（Verification） &amp; 确认（Validation）<br>（3）Test &amp; debug<br>（4）软件测试的目的<br>（5）测试的类型</p>
<p><strong>4. 软件测试在软件发展中扮演的角色</strong></p>
<p>略。</p>
<p><strong>5. 软件测试的基本原则</strong></p>
<ul>
<li>所有测试的标准都是建立在用户需求之上的，测试的目的在于发现系统是否满足规定的需求。</li>
<li>尽早的和不断的测试，越早进行测试，缺陷的修复成本就会越低。</li>
<li>程序员应避免检查自己的程序，由第三方进行测试更客观有效。</li>
<li>穷举测试是不可能的。</li>
<li>充分注意测试中的群集现象，一段程序中一发现的错误数越多，其中存在的错误概率越大，因此对发现错误较多的程序段，应进行更深入的测试。</li>
<li>设计测试用例时应包括合理输入和不合理输入，以及各种边界条件、特殊情况下要制造极端状态和意外状态。</li>
<li>注意回归测试的关联系，往往修改一个错误会引起更多错误。</li>
<li>测试应从“小规模”开始，逐步转向“大规模”。</li>
<li>测试用例式设计出来，不是写出来的，应根据测试的目的，采用相应的方法设计测试用例，从而提高测试的效率，更多的发现错误，提高程序的可靠性。</li>
<li>重视并妥善保存一切测试过程文档（测试计划，测试用例，测试报告等）。</li>
</ul>
<h2 id="Exercise1"><a href="#Exercise1" class="headerlink" title="Exercise1"></a>Exercise1</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.softwaretestinggenius.com/few-brain-teasing-questions-on-verification-and-validation-v-and-v/">答案</a></p>
</blockquote>
<p><strong>1. What sort of errors are covered by regression testing?</strong></p>
<p>问题：回归测试涵盖了哪些类型的错误？</p>
<p>软件回归测试是指修改了旧代码后，重新进行测试以确认修改没有引入新的错误或导致其他代码产生错误。回归测试主要包括四种类型的错误：</p>
<ul>
<li><p>数据损坏错误：由于共享数据，这些错误会导致副作用。</p>
</li>
<li><p>不适当的控制排序错误：由于执行顺序的变化，这些错误会导致副作用。例如，尝试在将项目放入队列之前将其从队列中删除。</p>
</li>
<li><p>资源争用：潜在瓶颈和死锁是此类错误的一些示例。</p>
</li>
<li><p>性能缺陷：计时错误和存储利用率错误是此类错误的一些示例。</p>
</li>
</ul>
<p><strong>2. What is an independent test organization? Why is it necessary?</strong></p>
<p>问题：什么是独立测试机构？为什么需要它？</p>
<p>独立测试组织是指测试产品或系统是否符合自愿共识标准的组织。 作为一个独立的测试机构，该机构不应被任何客户、行业组织或任何其他与被测试产品或系统有经济利益的个人或机构所有或控制。 对于按照自愿性共识标准对产品或系统进行认证、列表或标签的组织，它应保持对产品或系统生产的正式定期检查，以确保已列出、已认证或已标记的产品或系统继续满足适当的要求标准。</p>
<p><strong>3. What is interface analysis?</strong></p>
<p>问题：什么是接口分析？</p>
<p>它是对接口要求规范的详细检查。 这里的评估标准是软件与其他硬件、用户和外部软件之间的接口。</p>
<p>继续并更新软件的关键性分析。 关键性被分配给每个软件需求。 当需求组合成功能时，组合成功能，需求的组合关键性形成聚合功能的关键性。</p>
<p>随着需求变化的引入，关键性分析会定期更新，因为这种变化会导致功能关键性增加或降低，具体取决于修订后的需求如何影响系统关键性。</p>
<p><strong>4. Explain all the phases through which we can approach testing using a sample software testing problem. Comment on difficulty of testing.</strong></p>
<p>问题：解释我们可以使用示例软件测试问题进行测试的所有阶段。 评论测试的难度。</p>
<p>测试过程会依次经历单元测试、集成测试、系统测试、验收测试四个主要阶段：</p>
<ul>
<li>单元测试：单元测试是针对软件设计的最小单位––程序模块甚至代码段进行正确性检验的测试工作，通常由开发人员进行。</li>
<li>集成测试：集成测试是将模块按照设计要求组装起来进行测试，主要目的是发现与接口有关的问题。由于在产品提交到测试部门前，产品开发小组都要进行联合调试，因此在大部分企业中集成测试是由开发人员来完成的。</li>
<li>系统测试：系统测试是在集成测试通过后进行的，目的是充分运行系统，验证各子系统是否都能正常工作并完成设计的要求。它主要由测试部门进行，是测试部门最大最重要的一个测试，对产品的质量有重大的影响。</li>
<li>验收测试：验收测试以需求阶段的《需求规格说明书》为验收标准，测试时要求模拟实际用户的运行环境。对于实际项目可以和客户共同进行，对于产品来说就是最后一次的系统测试。测试内容为对功能模块的全面测试，尤其要进行文档测试。</li>
</ul>
<p><strong>5. What is program slicing?</strong></p>
<p>问题：什么是程序切片？</p>
<p>切片是一种程序分解技术，用于通过代码追溯输出变量，以识别与程序中的计算相关的所有代码语句。</p>
<h2 id="黑盒测试（Black-Box-Testing）"><a href="#黑盒测试（Black-Box-Testing）" class="headerlink" title="黑盒测试（Black-Box Testing）"></a>黑盒测试（Black-Box Testing）</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yeuteyietir/article/details/93522978">软件测试——黑盒测试</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/hongfuqiang/article/details/78840763">黑盒测试的测试方法</a></p>
</blockquote>
<p><strong>概念：</strong> 黑盒测试也称功能测试或数据驱动测试，它是在已知产品所应具有的功能，通过测试来检验每个功能都是否能够正常使用。</p>
<p><strong>黑盒测试用例的设计方法：</strong></p>
<ul>
<li>划分等价类（equivalence class partitioning）</li>
<li>边界值分析  <strong>BVA</strong>（boundary value analysis）</li>
<li>划分类别（category partitioning）</li>
<li>因果图（cause-effect graph）</li>
<li>决策表（decision table）</li>
</ul>
<h2 id="Exercise2"><a href="#Exercise2" class="headerlink" title="Exercise2"></a>Exercise2</h2><p><strong>1. Assume that you have a 10-character-wide ZIP code text box, such as the one shown in Figure 1. What equivalence partitions would you create for this text box?</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5aa6088211614fc6af0369e2ac16bf8d~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>问题：假设有一个要求输入10个字符的邮政编码，对于该文本框该如何等价分类？</p>
<p>至少含有以下等价区间：</p>
<ul>
<li>特殊字符，如10个*或￥；</li>
<li>英文字母，如ABCDefghik；</li>
<li>小于十个字符，如123；</li>
<li>大于十个字符，如11111111111；</li>
<li>数字和其他混合，如123AAAAAAA；</li>
<li>空字符；</li>
<li>保留字符；</li>
</ul>
<p><strong>2. What is the difference between weak normal and strong normal equivalence class testing?</strong></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/112810758">《等价类划分》-有这篇就够了</a></p>
</blockquote>
<p>问题：弱一般等价类和强一般等价类之间的区别？</p>
<p><strong>弱一般等价类：</strong> 遵循单缺陷原则，要求用例覆盖每一个变量的一种取值即可，取值为有效值。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e87845d2a1af491c86f54e2db448452b~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>强一般等价类：</strong> 遵循多缺陷原则，要求用例覆盖每个变量的每种取值之间的迪卡尔乘积，即<strong>所有变量所有取值的所有组合</strong>，取值为有效值。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e1b89f48658443318a3183345e7d3d9f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>3. Consider a program given below for the selection of the largest of numbers.</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">main() &#123;</span><br><span class="line">    <span class="type">float</span> A, B, C;</span><br><span class="line">    <span class="built_in">printf</span> (“Enter <span class="number">3</span> values:”);</span><br><span class="line">    <span class="built_in">scanf</span> (“%d%d%d”, &amp;A, &amp;B, &amp;C);</span><br><span class="line">    <span class="built_in">printf</span> (“Largest value is”);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (A &gt; B)  &#123;</span><br><span class="line">        <span class="keyword">if</span> (A &gt; C)</span><br><span class="line">            <span class="built_in">printf</span> (“%d\n”, A);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span> (“%d\n”, C);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (C &gt; B) </span><br><span class="line">            <span class="built_in">printf</span> (“%d”, C);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span> (“%f”, B);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>a. Design the set of test cases using BVA technique and equivalence class testing technique.</strong></p>
<p>问题：分别使用边界值分析和等价划分类方法设计测试用例。</p>
<ul>
<li>A, B, C 中一个或多个为非数字 （无效等价类）</li>
<li>A&gt;&#x3D;B and A&gt;&#x3D;C （有效等价类）</li>
<li>B&gt;&#x3D;A and B&gt;&#x3D;C （有效等价类）</li>
<li>C&gt;&#x3D;A and C&gt;&#x3D;B （有效等价类）</li>
</ul>
<p><strong>b. Select a set of test cases that will provide 100% statement coverage.</strong></p>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody><tr>
<td>10</td>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>10</td>
</tr>
<tr>
<td>1</td>
<td>5</td>
<td>10</td>
</tr>
<tr>
<td>1</td>
<td>10</td>
<td>5</td>
</tr>
</tbody></table>
<p><strong>c. Develop a decision table for this program.</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3660c9105b7e4b8b82d5724504f11e29~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>4. Drive equivalence class for input variables below.</strong></p>
<p><strong>a. int pen_inventory; （表示签字笔的当前库存）</strong></p>
<ul>
<li>有效等价类：非负整数</li>
<li>无效等价类：负数、小数或者其他任何形式的非数字的输入</li>
</ul>
<p><strong>b. string planet_name; （表示行星的名字）</strong></p>
<ul>
<li>有效等价类：已定义过的行星的名字</li>
<li>无效等价类：非定义的行星的名字、任何其他形式的特殊输入</li>
</ul>
<p><strong>c. operating_system&#x3D;{“OS X”, “Windows XP”, “Windows 2000”, “Unix”, “Linux”, “Xinu”, “VxWorks”}; （操作系统的名字）</strong></p>
<ul>
<li>有效等价类：集合中的任何一个操作系统名称</li>
<li>无效等价类：除开集合外的任何输入</li>
</ul>
<p><strong>d. printer_class&#x3D; set printer_name;（打印机名字的集合） printer_class p;</strong></p>
<ul>
<li>有效等价类：打印机集合中的任何一个名字</li>
<li>无效等价类：除了集合中内容外的任何输入</li>
</ul>
<p><strong>e. int name [1.10]; （一个最多包含10个整数的数组）</strong></p>
<ul>
<li>有效等价类：输入的长度在1到10之间（包括边界）的整数序列</li>
<li>无效等价类：空数组、长度超过10的数组、任何形式的包含一位或多位非数字的输入序列</li>
</ul>
<p><strong>5. Consider an example of grading a student in a university. The grading is done as below:</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e3157d5ee035444aa34bff9f5acc80aa~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>The marks of any three subjects are considered for the calculation of average marks. Scholarships of <code>$1000</code> and <code>$500</code> are given to students securing more than 90% and 85% marks, respectively. Develop a decision table, cause effect graph, and generate test cases for the above scenario.</strong></p>
<p>问题： 计算平均分时，会考虑任何三门科目的分数。 分别为分数超过 90% 和 85% 的学生提供 1000 美元和 500 美元的奖学金。 针对上述场景开发决策表、因果图并生成测试用例。</p>
<p>cause：</p>
<ul>
<li>c1 平均分大于90%</li>
<li>c2 平均分等于90%</li>
<li>c3 平均大于85%且平均分小于90%</li>
<li>c4 平均分大于等于75%且小于等于85%</li>
<li>c5 平均分大于等于60%且小于等于74%</li>
<li>c6 平均分大于等于50%且小于等于59%</li>
<li>c7 平均分大于等于0%且小于50%</li>
</ul>
<p>effect：</p>
<ul>
<li>e1 A+</li>
<li>e2 A</li>
<li>e3 B</li>
<li>e4 C</li>
<li>e5 Fail</li>
<li>e6 获得1000奖学金</li>
<li>e7 获得500奖学金</li>
</ul>
<p><strong>决策表：</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4369424c18d945de990303ac9cb729ea~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>因果图：</strong></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3e694e8bd9f4e8aa31887d7adc64dd0~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>测试用例：</strong></p>
<p>列举三个成绩的平均值分别对应cause中的几种情况</p>
<h2 id="白盒测试（White-Box-Testing）"><a href="#白盒测试（White-Box-Testing）" class="headerlink" title="白盒测试（White-Box Testing）"></a>白盒测试（White-Box Testing）</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Ming8006/p/5798186.html">白盒测试：理论基础</a></p>
</blockquote>
<p><strong>概念：</strong> 把测试对象看做一个透明的盒子，它允许测试人员利用程序内部的逻辑结构及有关信息，设计或选择测试用例，对程序所有逻辑路径进行测试。</p>
<p><strong>白盒测试基本要求：</strong></p>
<ul>
<li>保证一个模块中的所有独立路径至少被执行一次；</li>
<li>对所有的逻辑值均需要测试真、假两个分支；</li>
<li>在上下边界及可操作范围内运行所有循环；</li>
<li>检查内部数据结构以确保其有效性。</li>
</ul>
<p><strong>测试覆盖标准：</strong></p>
<ol>
<li><p><strong>语句覆盖</strong>：是一个比较弱的测试标准，它的含义是：选择足够的测试用例，<strong>使得程序中每个语句至少都能被执行一次</strong>。</p>
<ul>
<li>它是最弱的逻辑覆盖，效果有限，必须与其它方法交互使用。</li>
</ul>
</li>
<li><p><strong>判定覆盖</strong>（也称为<strong>分支覆盖</strong>）：执行足够的测试用例，<strong>使得程序中的每一个分支至少都通过一次</strong>。</p>
<ul>
<li>判定覆盖只比语句覆盖稍强一些，但实际效果表明，只是判定覆盖，还不能保证一定能查出在判断的条件中存在的错误。因此，还需要更强的逻辑覆盖准则去检验判断内部条件。</li>
</ul>
</li>
<li><p><strong>条件覆盖</strong>：执行足够的测试用例，<strong>使程序中每个判断的每个条件的每个可能取值至少执行一次</strong>。</p>
<ul>
<li>条件覆盖深入到判定中的每个条件，但可能不能满足判定覆盖的要求。</li>
</ul>
</li>
<li><p><strong>判定&#x2F;条件覆盖</strong>：执行足够的测试用例，<strong>使得判定中每个条件取到各种可能的值，并使每个判定取到各种可能的结果。</strong></p>
</li>
<li><p><strong>条件组合覆盖</strong>：执行足够的例子，<strong>使得每个判定中条件的各种可能组合都至少出现一次</strong>。</p>
<ul>
<li>这是一种相当强的覆盖准则，可以有效地检查各种可能的条件取值的组合是否正确。</li>
<li>它不但可覆盖所有条件的可能取值的组合，还可覆盖所有判断的可取分支，但可能有的路径会遗漏掉。</li>
<li>测试还不完全。</li>
</ul>
</li>
</ol>
<p><strong>白盒测试的主要方法：</strong></p>
<ol>
<li><p>逻辑驱动测试</p>
<ul>
<li>语句覆盖</li>
<li>判定覆盖</li>
<li>条件覆盖</li>
<li>判定&#x2F;条件覆盖</li>
<li>条件组合覆盖</li>
</ul>
</li>
<li><p>路径测试</p>
<ul>
<li>路径测试就是设计足够多的测试用例，覆盖被测试对象中的所有可能路径。这是最强的覆盖准则。</li>
<li>基本路径测试：设计足够多的测试用例，运行所测程序，<strong>要覆盖程序中所有可能的路径</strong>。但在路径数目很大时，真正做到完全覆盖是很困难的，<strong>必须把覆盖路径数目压缩到一定限度</strong>。例如程序中的循环体只执行一次。</li>
</ul>
</li>
</ol>
<h2 id="Exercise3"><a href="#Exercise3" class="headerlink" title="Exercise3"></a>Exercise3</h2><p><strong>1. The basis set for a program is constructed using its CFG（Control Flow Graph）. Now suppose that the program contains compound predicates. Do you think the basis set for this program will depend on how compound predicates are represented in the flow graph? Explain your answer.</strong></p>
<p>问题：程序的基本组成是使用控制流图构建的。现在假设程序包含复合谓词，你认为复合谓词在流程图中的表示方式会决定这个程序的基本组成吗？ 解释你的答案。</p>
<p>不会。当一个普通的流程图中有复合谓词时，这些谓词之间会指示出不止一个基本路径。为了给程序构建一个基集，复合谓词应该被拆分成不能再分解的节点，以暴露更详细的路径，这有利于以后更彻底地创建测试用例。</p>
<p>*<em>2. Example 2. 1 Consider the following program that takes two non-negative integers <em>x</em>1 and <em>y</em>1 as inputs and computes their greatest common divisor.</em>*</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c7e3a512b9984155a34ce76b832bcf52~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>(a) List the different paths in the program in Example2.1 when the loop body is traversed twice.</strong></p>
<p>问题： 列出例 2.1 中程序中循环体被遍历两次时的不同路径。</p>
<p>流程控制图：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ea35b228d1e4fa39b96737cbaba7915~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>路径：</p>
<p>P1 &#x3D; { Start, 1, 2, 3, 4, 5, 3, 4, 5, 3, 7, End }</p>
<p>P2 &#x3D; { Start, 1, 2, 3, 4, 5, 3, 4, 6, 3, 7, End }</p>
<p>P3 &#x3D; { Start, 1, 2, 3, 4, 6, 3, 4, 5, 3, 7, End }</p>
<p>P4 &#x3D; { Start, 1, 2, 3, 4, 6, 3, 4, 6, 3, 7, End }</p>
<p><strong>(b) For each path list the path conditions and a few sample values in the corresponding input domain.</strong></p>
<p>问题： 对于每个路径，列出相应输入域中的路径条件和一些示例值。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e020b2474304adfaed8b2aa58f6710e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>3. struct a program in your favorite language that inputs three integers x, y, and z and computes output O using the specification in Table 1. Assume that <em>f</em> <em>1</em> <em>(x, y, z) &#x3D; x + y + z and f</em> <em>2</em> <em>(x, y, z) &#x3D; x * y * z</em>.</strong></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/65aafa4407e9445995e6d464f11331e7~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>Introduce an error in your program. Now construct a test set Τ that is decision-adequate, but is not multiple condition-adequate, and does not reveal the error you introduced. Enhance Τ so that it is multiple condition-adequate and does reveal the error. Will all tests that are multiple condition-adequate for your program reveal the error?</strong></p>
<p>下面一段代码的边界处处理有问题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params">x, y, z</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y +z</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f2</span>(<span class="params">x, y, z</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x*y*z</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">answer</span>(<span class="params">x, y, z</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(x &lt; y) &#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt;= z ? <span class="title function_">f1</span>(x, y, z) : <span class="title function_">f2</span>(x, y, z)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> x &lt;= z ? <span class="title function_">f2</span>(x, y, z) : <span class="title function_">f1</span>(x, y, z)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果符合预期：</p>
<pre><code>T1 = &#123;

t1 = &lt; x = 3, y = 5, z = 7&gt;, // expected: 15

t2 = &lt; x = 5, y = 7, z = 3&gt;, // expected: 105

t3 = &lt; x = 5, y = 3, z = 7&gt;, // expected: 105

t4 = &lt; x = 7, y = 5, z = 3&gt; // expected: 15

&#125;
</code></pre>
<p>测试出程序有问题：</p>
<pre><code>T2 = &#123;

t1 = &lt; x = 3, y = 5, z = 7&gt;, // expected: 15

t2 = &lt; x = 5, y = 7, z = 3&gt;, // expected: 105

**t3 = &lt; x = 6, y = 7, z = 6&gt;,** **/** **/ expected: 252**

t4 = &lt; x = 5, y = 3, z = 7&gt;, // expected: 105

**t5 = &lt; x = 4, y = 4, z = 7&gt;, // expected: 112**

t6 = &lt; x = 7, y = 5, z = 3&gt;, // expected: 15

t7 = &lt; x = 3, y = 3, z = 3&gt; // expected: 9

&#125;
</code></pre>
<h2 id="Exercise4"><a href="#Exercise4" class="headerlink" title="Exercise4"></a>Exercise4</h2><p><strong>BOR</strong></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8ee07ee61b5145c4b32fee83b7673458~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>BRO</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28f1c93601d9446795ad6234a3929ebe~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>1. Consider the condition <em>C</em> : (<em>a +</em> 1 &gt; <em>b</em>)∧ (<em>c</em> &#x3D; <em>d</em>) <em>,</em> where <em>a, b, c,</em> and <em>d</em> are type compatible variables.</strong></p>
<p>**(a) Let <em>S</em>1 &#x3D; {(&gt;, &#x3D;), (&gt;, &gt;), (&gt;, &lt;), (&#x3D;, &#x3D;),(&lt;, &#x3D;)} be a set of constraints on <em>C</em>. please  construct a test set <em>T</em>1 that satisfies <em>S</em>1 and show that <em>T</em> is BRO-adequate.**</p>
<p>**(b) Now consider the constraint set <em>S</em>2 <em>&#x3D;</em> {(+ϵ, &#x3D;), (&#x3D;, –ϵ), (–ϵ, &#x3D;), (+ϵ, +ϵ)} on <em>C</em>. Construct a test set <em>T</em>2 that satisfies <em>S</em>2 <em>.</em> Is <em>T</em> BRE adequate ? Assume that ϵ &#x3D; 1**</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fcec277d83ac472bbb1967474f9ccb3b~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>2. Let <em>A</em> &#x3D; {(&lt;, &#x3D;), (&gt;, &lt;)} and *Β* &#x3D; {(t, &#x3D;), (t, &gt;), (f, &lt;)} be two constraint sets. Compute <em>A × B</em> and <em>A</em> ⊗ <em>B.</em></strong></p>
<p><em>A × B &#x3D;</em>  {(&lt;, &#x3D;, t, &#x3D;), (&lt;, &#x3D;, t, &gt;), (&lt;, &#x3D;, f, &lt;), (&gt;, &lt;, t, &#x3D;), (&gt;, &lt;, t, &gt;), (&gt;, &lt;, f, &lt;)}</p>
<p><em>A</em> ⊗ <em>B</em> &#x3D; {(&lt;, &#x3D;, t, &#x3D;), (&gt;, &lt;, t, &lt;), (&gt;, &lt;, f, &lt;)}</p>
<p><strong>3. Consider the cause-effect graph shown in Figure 1 that exhibits the relationship between several causes and effect <em>E.</em></strong></p>
<p><strong>(1) Derive a test set <em>T</em> <em>CEG</em> to test the implementation of <em>Ε</em> using the test generation procedure described in Cause-effect graphing.</strong></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/30f68b7fa6704852bf37e520b69ca1c7~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><strong>(2) Construct a Boolean expression <em>p</em> <em>r</em> from the Figure1 that represents the condition for the effect to occur. Select one of the two procedures BOR-CSET, BRO-CSET and apply it to construct a test set from <em>p</em> <em>r</em> <em>.</em>  Assume that there might be errors in the relational expressions that represent various causes effecting <em>E.</em> Construct a test set <em>T</em> <em>B</em> from the constraints you derive.</strong></p>
<p>(1)</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ab9673c475924938a2b4a6866106b452~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">E = -( (a&lt;b) ^ (c &gt;d) ) V ( w )</span><br><span class="line"></span><br><span class="line">T_CEG = &#123;</span><br><span class="line"></span><br><span class="line">    t1: &lt;a=1, b=2, c=1, d=0, w=t&gt;,</span><br><span class="line"></span><br><span class="line">    t2: &lt;a=1, b=2, c=1, d=1, w=t&gt;,</span><br><span class="line"></span><br><span class="line">    t3: &lt;a=1, b=0, c=1, d=0, w=t&gt;,</span><br><span class="line"></span><br><span class="line">    t4: &lt;a=1, b=0, c=1, d=1, w=t&gt;,</span><br><span class="line"></span><br><span class="line">    t5: &lt;a=1, b=1, c=1, d=1, w=f&gt;,</span><br><span class="line"></span><br><span class="line">    t6: &lt;a=1, b=0, c=1, d=0, w=f&gt;,</span><br><span class="line"></span><br><span class="line">    t7: &lt;a=1, b=0, c=1, d=1, w=f&gt;,</span><br><span class="line"></span><br><span class="line">    t8: &lt;a=1, b=1, c=1, d=0, w=f&gt;,</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pr = -( (a&lt;b) ^ (c &gt;d) ) V ( w )</span><br></pre></td></tr></table></figure>

<p>BRO</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e6bdfac2f72433ba5ea6d719ac1b0f8~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62304451d1cb47f8bceb271cd00bd3f9~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h2 id="单元测试（Unit-Testing）"><a href="#单元测试（Unit-Testing）" class="headerlink" title="单元测试（Unit Testing）"></a>单元测试（Unit Testing）</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a3fa5d208c93">使用JUnit进行单元测试</a></p>
</blockquote>
<h2 id="集成测试（Integration-Testing）"><a href="#集成测试（Integration-Testing）" class="headerlink" title="集成测试（Integration Testing）"></a>集成测试（Integration Testing）</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/chengyuweng7838/article/details/100996270">什么是集成测试（集成测试示例教程）</a></p>
</blockquote>
<h2 id="性能测试（Performance-Testing）"><a href="#性能测试（Performance-Testing）" class="headerlink" title="性能测试（Performance Testing）"></a>性能测试（Performance Testing）</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/puresoul/p/5456855.html">性能测试总结(一)—基础理论篇</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/puresoul/p/5463477.html">性能测试总结(二)—测试流程篇</a></p>
</blockquote>
<h2 id="Exercise5"><a href="#Exercise5" class="headerlink" title="Exercise5"></a>Exercise5</h2><p><strong>1. How to conduct performance testing?</strong></p>
<p>问题：如何进行性能分析？</p>
<ul>
<li>性能需求分析</li>
<li>测试准备</li>
<li>测试执行</li>
<li>结果分析和调优</li>
<li>报告和总结</li>
</ul>
<p><strong>2. 案例分析:针对某公司办公自动化（OA）系统的负载压力测试，采用专业的负载压力测试工具来执行测试。系统采用 Browse&#x2F;Server 架构，服务器是一台 PC Server （4 路 2.7GHz 处理器， 4GB  内存），安装的平台软件包括 Microsoft  Internet  Information  Server  5.0，ASP.NET， SQLServer 2000。使用 2 台笔记本电脑安装测试工具模拟客户端执行“登录”业务操作。</strong></p>
<p><strong>测试需求分别为以下两个：</strong></p>
<p><strong>第一，测试系统分别在 2M、4M 网络带宽下，能够支持用户登录的最大并发用户数；</strong> </p>
<p><strong>第二，测试服务器的吞吐量（即：每秒可以处理的交易数），主要包括服务器 CPU 平均使用率达到 85%时系统能够支持的最大吞吐量和服务器 CPU 平均使用率达到 100%时系统能够支持的最大吞吐量。</strong></p>
<p><strong>本次性能测试的测试目标是：</strong></p>
<p><strong>1） 指标“响应时间”合理范围为 0～5 秒，可支持的最大并发用户数；</strong></p>
<p><strong>2） 评测系统的服务器资源是否合理，是否需要进行改进。</strong></p>
<p><strong>3） 网络带宽是否使用合理。</strong></p>
<p><strong>作为一个测试人员，你准备怎么实施本项任务？</strong></p>
<p>结合第一题的几个步骤自己发挥</p>
<h2 id="系统测试（System-Testing）"><a href="#系统测试（System-Testing）" class="headerlink" title="系统测试（System Testing）"></a>系统测试（System Testing）</h2><p><strong>系统测试概念</strong></p>
<p><strong>系统测试方法</strong></p>
<p><strong>系统测试过程</strong></p>
<p><strong>FSM（自动机）</strong></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/docs/share/af6b8877-5bba-4d52-aebd-d39520f85963#">计算题（小天版本）</a></p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/12/Java%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/12/Java%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%B0%84/" class="post-title-link" itemprop="url">Java中的反射</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-12 17:06:13" itemprop="dateCreated datePublished" datetime="2021-11-12T17:06:13+08:00">2021-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:47:47" itemprop="dateModified" datetime="2023-05-07T17:47:47+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="反射：框架设计的灵魂"><a href="#反射：框架设计的灵魂" class="headerlink" title="反射：框架设计的灵魂"></a>反射：框架设计的灵魂</h2><p><strong>概念：</strong> 将类的各个组成部分<strong>封装为其他对象</strong>，这就是反射机制。</p>
<p><strong>Java代码在计算机中经历的三个阶段：</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7362531b029345ae822610dd5dd32891~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>好处：</p>
<ul>
<li>可以在程序运行的过程中可以操作这些对象</li>
<li>可以解耦，提高程序的可扩展性</li>
</ul>
<p><strong>获取<code>class</code>对象的三个阶段，分别对应上面的三个阶段：</strong></p>
<ul>
<li><code>class.forName(&quot;全类名&quot;)</code>：将字节码文件加载进内存，返回<code>class</code>对象<ul>
<li>多用于配置文件，将类名定义在配置文件中。读取文件，加载类。</li>
</ul>
</li>
<li><code>类名.class</code>：通过类名的属性获取<ul>
<li>多用于参数的传递</li>
</ul>
</li>
<li><code>对象.getClass()</code>：继承自<code>Object</code>的方法<ul>
<li>多用于对象的获取字节码的方式</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.domian.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo1</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Class</span> <span class="variable">cls1</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;cn.itcast.domian.Person&quot;</span>);</span><br><span class="line">    System.out.println(cls1);</span><br><span class="line"></span><br><span class="line">    <span class="type">Class</span> <span class="variable">cls2</span> <span class="operator">=</span> Person.class;</span><br><span class="line">    System.out.println(cls2);</span><br><span class="line"></span><br><span class="line">    <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    <span class="type">Class</span> <span class="variable">cls3</span> <span class="operator">=</span> p.getClass();</span><br><span class="line">    System.out.println(cls3);</span><br><span class="line"></span><br><span class="line">    System.out.println(cls1 == cls2); <span class="comment">// true</span></span><br><span class="line">    System.out.println(cls1 == cls3); <span class="comment">// true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结论：同一个字节码文件（.class）在一次程序运行的过程中，只会被加载一次，不论是通过哪一种方式获取的<code>class</code>对象都是一个。</p>
<h2 id="class对象的功能"><a href="#class对象的功能" class="headerlink" title="class对象的功能"></a>class对象的功能</h2><h3 id="获取成员变量们"><a href="#获取成员变量们" class="headerlink" title="获取成员变量们"></a>获取成员变量们</h3><ul>
<li><code>Field[] getFileds()</code>：获取所有<code>public</code>修饰的成员变量</li>
<li><code>Field[] getFiled(String name)</code>：获取指定的<code>public</code>修饰的成员变量</li>
<li><code>Field[] getDeclareFileds()</code>：获取所有的成员变量（不考虑修饰符）</li>
<li><code>Field[] getDeclareFiled(String name)</code>：获取指定的成员变量（不考虑修饰符）</li>
</ul>
<p><code>Filed</code>：成员变量</p>
<ul>
<li>获取值：<code>void set(Object obj, Object value)</code></li>
<li>设置值：<code>get(Object obj)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.domian.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo2</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Class</span> <span class="variable">personClass</span> <span class="operator">=</span> Person.class;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取成员变量</span></span><br><span class="line">    System.out.println(<span class="string">&quot;========getFields========&quot;</span>);</span><br><span class="line">    Field[] fileds = personClass.getFields();</span><br><span class="line">    <span class="keyword">for</span>(Field field: fileds) &#123;</span><br><span class="line">      System.out.println(field);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;---------------&quot;</span>);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">a</span> <span class="operator">=</span> personClass.getField(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> a.get(p);</span><br><span class="line">    System.out.println(value);</span><br><span class="line">    a.set(p, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    System.out.println(p);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;=======getDeclaredFields=========&quot;</span>);</span><br><span class="line">    Field[] declareFileds = personClass.getDeclaredFields();</span><br><span class="line">    <span class="keyword">for</span>(Field field: declareFileds) &#123;</span><br><span class="line">      System.out.println(field);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;---------------&quot;</span>);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">name</span> <span class="operator">=</span> personClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="comment">// 直接访问private会报错，该设置可以忽略权限修饰符的安全检查</span></span><br><span class="line">    name.setAccessible(<span class="literal">true</span>); <span class="comment">// 暴力反射</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">value2</span> <span class="operator">=</span> name.get(p);</span><br><span class="line">    System.out.println(value2);</span><br><span class="line">    name.set(p, <span class="string">&quot;wk&quot;</span>);</span><br><span class="line">    System.out.println(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f37ccf0912ef487c8297dd00dd8275a3~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/08bb66e65c7f424ba6392fcd116a8409~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h3 id="获取构造方法们"><a href="#获取构造方法们" class="headerlink" title="获取构造方法们"></a>获取构造方法们</h3><ul>
<li><code>Constructor&lt;?&gt;[] getConstructors()</code></li>
<li><code>Constructor&lt;T&gt; getConstructor(类&lt;?&gt;... parameterTypes)</code></li>
<li><code>Constructor&lt;?&gt;[] getDeclareConstructors()</code></li>
<li><code>Constructor&lt;T&gt; getDeclareConstructor(类&lt;?&gt;... parameterTypes)</code></li>
</ul>
<p><code>Constructor</code>：构造方法</p>
<ul>
<li>创建对象：<code>T newInstance(Object... initargs)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.domian.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo3</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Class</span> <span class="variable">personClass</span> <span class="operator">=</span> Person.class;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取成员变量</span></span><br><span class="line">    System.out.println(<span class="string">&quot;========getConstructors========&quot;</span>);</span><br><span class="line">    <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> personClass.getConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">    System.out.println(constructor);</span><br><span class="line">    <span class="comment">// 创建对象</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">person</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">33</span>);</span><br><span class="line">    System.out.println(person);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;=======getDeclareConstructors=========&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86593d22a1364f9fa84e96e4b8897c20~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h3 id="获取成员方法们"><a href="#获取成员方法们" class="headerlink" title="获取成员方法们"></a>获取成员方法们</h3><ul>
<li><code>Method[] getMethods()</code></li>
<li><code>Method getMethod(String name, 类&lt;?&gt;... parameterTypes)</code></li>
<li><code>Method[] getDeclareMethods()</code></li>
<li><code>Method getDeclareMethod(String name, 类&lt;?&gt;... parameterTypes)</code></li>
</ul>
<p><code>Method</code>：方法对象</p>
<ul>
<li>执行方法：<code>Object invoke(Objcet obj, Object... args)</code></li>
<li>获取方法名称：<code>String getName()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.domian.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectDemo4</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Class</span> <span class="variable">personClass</span> <span class="operator">=</span> Person.class;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取成员变量</span></span><br><span class="line">    System.out.println(<span class="string">&quot;========getMethods========&quot;</span>);</span><br><span class="line">    Method[] methods = personClass.getMethods();</span><br><span class="line">    <span class="keyword">for</span>(Method m: methods) &#123;</span><br><span class="line">      System.out.println(m);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-----------------&quot;</span>);</span><br><span class="line">    <span class="type">Method</span> <span class="variable">eat_Method</span> <span class="operator">=</span> personClass.getMethod(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">    eat_Method.invoke(p);</span><br><span class="line"></span><br><span class="line">    <span class="type">Method</span> <span class="variable">eat_Method2</span> <span class="operator">=</span> personClass.getMethod(<span class="string">&quot;eat&quot;</span>, String.class);</span><br><span class="line">    eat_Method2.invoke(p,<span class="string">&quot;apple&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;=======getDeclareConstructors=========&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;省略。。&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eff07486ade04e78a124f076ed0741d9~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h2 id="反射小应用"><a href="#反射小应用" class="headerlink" title="反射小应用"></a>反射小应用</h2><p>写一个“框架”，可以帮我们创造任意类的对象，并执行其中任意方法。</p>
<p><strong>实现：</strong></p>
<ul>
<li>配置文件</li>
<li>反射</li>
</ul>
<p><strong>步骤：</strong></p>
<ul>
<li>将需要创建的对象的全类名和需要执行的方法定义在配置文件中</li>
<li>在程序中加载读取配置文件</li>
<li>使用反射技术加载类进内存</li>
<li>创建对象</li>
<li>执行方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, Exception &#123;</span><br><span class="line">    <span class="comment">// 可以帮我们创造任意类的对象，并执行其中任意方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 加载配置文件</span></span><br><span class="line">    <span class="comment">// 1.1 创建 Properties 对象</span></span><br><span class="line">    <span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">    <span class="comment">// 1.2 加载配置文件， 转换成一个集合</span></span><br><span class="line">    <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> ReflectTest.class.getClassLoader();</span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> classLoader.getResourceAsStream(<span class="string">&quot;pro.properties&quot;</span>);</span><br><span class="line">    pro.load(is);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 获取配置文件中的定义数据</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> pro.getProperty(<span class="string">&quot;className&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> pro.getProperty(<span class="string">&quot;methodName&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 加载该类进内存</span></span><br><span class="line">    <span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4.创建对象</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 获取方法对象</span></span><br><span class="line">    <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(methodName);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 执行方法</span></span><br><span class="line">    method.invoke(obj);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bfadd2b295654f5384fb6186b1266a2e~tplv-k3u1fbpfcp-watermark.image" alt="image.png">
    </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/12/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/12/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/" class="post-title-link" itemprop="url">Java中的注解</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-12 17:06:13" itemprop="dateCreated datePublished" datetime="2021-11-12T17:06:13+08:00">2021-11-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:47:55" itemprop="dateModified" datetime="2023-05-07T17:47:55+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p><strong>概念：</strong> 注解，也叫元数据。JDK1.5后提出的新特性，用于描述新特性。使用注解：<code>@注解名称</code></p>
<p><strong>作用分类：</strong></p>
<ul>
<li><p>编写文档：通过代码里标识的注解生成文档</p>
</li>
<li><p>代码分析：通过代码里的标识的注解对代码进行分析【使用反射】</p>
</li>
<li><p>编译检查：通过代码里标识的注解让编译器能够实现基本的编译检查</p>
</li>
</ul>
<h2 id="jdk预定义的注解"><a href="#jdk预定义的注解" class="headerlink" title="jdk预定义的注解"></a>jdk预定义的注解</h2><ul>
<li>@Deprecated 已过期，表示方法是不被建议使用的</li>
<li>@Override 重写，标识覆盖它的父类的方法</li>
<li>@SuppressWarnings 压制警告，抑制警告</li>
</ul>
<p><strong>Deprecated 注解</strong></p>
<p>可以修饰类、方法、变量，在java源码中被@Deprecated修饰的类、方法、变量等表示不建议使用的，可能会出现错误的，可能以后会被删除的类、方法等，如果现在使用，则在以后使用了这些类、方法的程序在更新新的JDK、jar包等就会出错，不再提供支持。<br>个人程序中的类、方法、变量用@Deprecated修饰同样是不希望自己和别人在以后的时间再次使用此类、方法。当编译器编译时遇到了使用@Deprecated修饰的类、方法、变量时会提示相应的警告信息。</p>
<p><strong>Override 注解</strong></p>
<p>指明被注解的方法需要覆写超类中的方法，如果某个方法使用了该注解，却没有覆写超类中的方法(如大小写写错了，或者参数错了，或者是子类自己定义的方法)，编译器就会生成一个错误。<br>在子类中重写父类或接口的方法，@Overide并不是必须的。但是还是建议使用这个注解，在某些情况下，假设你修改了父类的方法的名字，那么之前重写的子类方法将不再属于重写，如果没有@Overide，你将不会察觉到这个子类的方法。有了这个注解修饰，编译器则会提示你这些信息。</p>
<p><strong>Suppresswarnings 注解</strong></p>
<p>@SuppressWarnings用来抑制编译器生成警告信息，可以修饰的元素为类，方法，方法参数，属性，局部变量。它可以达到抑制编译器编译时产生警告的目的，使用@SuppressWarnings注解，采用就近原则，比如一个方法出现警告，尽量使用@SuppressWarnings注解这个方法，而不是注解方法所在的类。所属范围越小越好，因为范围大了，不利于发现该类下其他方法的警告信息。<br>但是很不建议使用@SuppressWarnings注解，使用此注解，开发人员看不到编译时编译器提示的相应的警告，不能选择更好、更新的类、方法或者不能编写更规范的编码。同时后期更新JDK、jar包等源码时，使用@SuppressWarnings注解的代码可能受新的JDK、jar包代码的支持，出现错误，仍然需要修改。</p>
<h2 id="自己定义注解"><a href="#自己定义注解" class="headerlink" title="自己定义注解"></a>自己定义注解</h2><p><strong>格式：</strong> <code>public @interface 名称</code></p>
<p><strong>本质：</strong> 就是一个接口，默认继承<code>Annotation</code>接口</p>
<ul>
<li><code>public interface MyAnno extends java.lang.annotation.Annotation &#123;&#125;</code></li>
</ul>
<p><strong>属性：</strong> 接口中的抽象方法，有如下要求：</p>
<ul>
<li>属性的返回值类型<ul>
<li>基本数据类型</li>
<li>字符串 <code>String</code></li>
<li>枚举</li>
<li>注解</li>
<li>以上类型的数组</li>
</ul>
</li>
<li>定义了属性，在使用时需要给属性赋值<ul>
<li>可以使用<code>default</code>初始化默认值</li>
<li>如果只有一个属性需要赋值，并且属性的名称是<code>value</code>可以直接写值</li>
<li>数组赋值时，使用大括号。如果数组中只有一个值，大括号可以省略</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnno &#123;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">show1</span><span class="params">()</span>;</span><br><span class="line">  String <span class="title function_">show2</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">  Person <span class="title function_">per</span><span class="params">()</span>;</span><br><span class="line">  MyAnno2 <span class="title function_">anno2</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">  String[] strs();</span><br><span class="line">  <span class="type">int</span> <span class="title function_">age</span><span class="params">()</span>;</span><br><span class="line">  String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;wk&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.annotation;</span><br><span class="line"></span><br><span class="line"><span class="meta">@MyAnno(age=12, name=&quot;cy&quot;, ...)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>元注解：</strong> 用于描述注解的注解</p>
<ul>
<li><code>@Target</code>：描述注解能够作用的位置<ul>
<li><code>ElemenType.TYPE</code>：类</li>
<li><code>ElemenType.METHOD</code>：方法</li>
<li><code>ElemenType.FIELD</code>：成员变量上</li>
</ul>
</li>
<li><code>@Retention</code>：描述注解被保留的阶段<ul>
<li><code>@Retention(value=&#123;RetentionPolicy.RUNTIME&#125;)</code>：当前被描述的注解，会保留到class字节码文件中，并被JVM读取到</li>
</ul>
</li>
<li><code>@Documented</code>：描述注解是否被抽取到api文档</li>
<li><code>@Inherited</code>：描述注解是否被子类继承</li>
</ul>
<h2 id="在程序中使用注解"><a href="#在程序中使用注解" class="headerlink" title="在程序中使用注解"></a>在程序中使用注解</h2><p>配合反射进行一个小测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 描述需要去执行的类名和方法名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Pro &#123;</span><br><span class="line">  String <span class="title function_">className</span><span class="params">()</span>;</span><br><span class="line">  String <span class="title function_">methodName</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pro(className = &quot;cn.itcast.annotation.Demo1&quot;, methodName = &quot;show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// 1. 解析注解</span></span><br><span class="line">    <span class="comment">// 1.1 获取该类的字节码文件</span></span><br><span class="line">    Class&lt;ReflectTest&gt; reflectTestClass = ReflectTest.class;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 获取上边的注解对象</span></span><br><span class="line">    <span class="type">Pro</span> <span class="variable">an</span> <span class="operator">=</span> reflectTestClass.getAnnotation(Pro.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 调用注解中的抽象方法，获取返回值</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> an.className();</span><br><span class="line">    <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> an.methodName();</span><br><span class="line">    System.out.println(className);</span><br><span class="line">    System.out.println(methodName);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 加载该类进内存</span></span><br><span class="line">    <span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5.创建对象</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 获取方法对象</span></span><br><span class="line">    <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(methodName);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7. 执行方法</span></span><br><span class="line">    method.invoke(obj);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




























      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/10/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/10/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/" class="post-title-link" itemprop="url">Java中的泛型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-10 17:06:13" itemprop="dateCreated datePublished" datetime="2021-11-10T17:06:13+08:00">2021-11-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:47:51" itemprop="dateModified" datetime="2023-05-07T17:47:51+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-为什么使用泛型"><a href="#1-为什么使用泛型" class="headerlink" title="1. 为什么使用泛型"></a>1. 为什么使用泛型</h2><p>泛型程序设计意味着编写的代码可以对多种不同类型的对象重用。</p>
<h3 id="1-1-类型参数"><a href="#1-1-类型参数" class="headerlink" title="1.1 类型参数"></a>1.1 类型参数</h3><p>在Java添加泛型类型之前，泛型程序设计是使用继承实现的。<code>ArrayList</code>类只维护一个<code>Object</code>引用的数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Object[] elementData;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(<span class="type">int</span> i)</span> &#123;...&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Object o)</span> &#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>存在问题：</p>
<ul>
<li>获取一个值时，必须进行强制类型转换</li>
<li>没有错误坚持，可以向数组列表添加任何类的值</li>
</ul>
<p>泛型的解决方案：类型参数，指示元素类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;String&gt; files = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br></pre></td></tr></table></figure>

<ul>
<li>使用<code>get</code>时不需要进行强制类型转换</li>
<li>使用<code>add</code>方法时必须插入指定类型的参数</li>
<li>程序更加易读，也更加安全</li>
</ul>
<h2 id="2-泛型类"><a href="#2-泛型类" class="headerlink" title="2. 泛型类"></a>2. 泛型类</h2><p>泛型类就是有一个或多个类型变量的类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pair</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">private</span> T first;</span><br><span class="line">  <span class="keyword">private</span> T second;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">()</span> &#123;</span><br><span class="line">    first = <span class="literal">null</span>;</span><br><span class="line">    second = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(T first, T second)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.first = first;</span><br><span class="line">    <span class="built_in">this</span>.second = second;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> T <span class="title function_">getFirst</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> first;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> T <span class="title function_">getSecond</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> second;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFirst</span><span class="params">(T newValue)</span> &#123;</span><br><span class="line">    first = newValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">pairTest</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    String[] words = &#123; <span class="string">&quot;Mary&quot;</span>, <span class="string">&quot;had&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;little&quot;</span>, <span class="string">&quot;lamb&quot;</span> &#125;;</span><br><span class="line">    Pair&lt;String&gt; mm = ArrayAlg.minmax(words);</span><br><span class="line">    System.out.println(<span class="string">&quot;min = &quot;</span> + mm.getFirst());</span><br><span class="line">    System.out.println(<span class="string">&quot;max = &quot;</span> + mm.getSecond());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ArrayAlg</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> Pair&lt;String&gt; <span class="title function_">minmax</span><span class="params">(String[] a)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(a == <span class="literal">null</span> || a.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">min</span> <span class="operator">=</span> a[<span class="number">0</span>];</span><br><span class="line">    <span class="type">String</span> <span class="variable">max</span> <span class="operator">=</span> a[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (min.compareTo(a[i]) &gt; <span class="number">0</span>) min = a[i];</span><br><span class="line">      <span class="keyword">if</span> (min.compareTo(a[i]) &lt; <span class="number">0</span>) max = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Pair</span>&lt;&gt;(min, max);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>泛型类也可以有多个类型变量</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pair</span>&lt;T, U&gt; &#123;...&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3-泛型方法"><a href="#3-泛型方法" class="headerlink" title="3. 泛型方法"></a>3. 泛型方法</h2><p>不但可以定义泛型类，还可以定义泛型方法。</p>
<ul>
<li>类型变量放在修饰符的后面，返回类型的前面</li>
<li>泛型方法可以在普通类中定义，也可以在泛型类中定义</li>
<li>当调用一个泛型方法时，可以把具体类型包围在尖括号中，放在方法名前</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ArrayAlg</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getMiddle</span><span class="params">(T... a)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a[a.length / <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-类型变量的限定"><a href="#4-类型变量的限定" class="headerlink" title="4. 类型变量的限定"></a>4. 类型变量的限定</h2><p>有时，类或方法需要对类型变量加以约束。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ArrayAlg</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">min</span><span class="params">(T[] a)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(a == <span class="literal">null</span> || a.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">T</span> <span class="variable">smallest</span> <span class="operator">=</span> a[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span>(smallest.compareTo(a[i]) &gt; <span class="number">0</span>) smallest = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> smallest;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里计算最新需要<code>T</code>拥有一个<code>Comparable</code>接口，我们可以对其加一个限定来实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ArrayAlg</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Comparable</span>&gt; T <span class="title function_">min</span><span class="params">(T[] a)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(a == <span class="literal">null</span> || a.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">T</span> <span class="variable">smallest</span> <span class="operator">=</span> a[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span>(smallest.compareTo(a[i]) &gt; <span class="number">0</span>) smallest = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> smallest;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样<code>min</code>方法只能在实现了<code>Compareable</code>接口的类的数组上调用。</p>
<p>为什么使用<code>extends</code>而不是<code>implements</code>？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;T <span class="keyword">extends</span> <span class="title class_">BoundingType</span>&gt;</span><br></pre></td></tr></table></figure>

<p>表示<code>T</code>是限定类型的子类型。<code>T</code>和限定类型都可以是类，也可以是接口。选择<code>extends</code>是因为它更接近子类型的概念。</p>
<ul>
<li>类型变量用逗号分隔</li>
<li>限定符号用<code>&amp;</code>分隔</li>
</ul>
<h2 id="5-泛型代码和虚拟机"><a href="#5-泛型代码和虚拟机" class="headerlink" title="5. 泛型代码和虚拟机"></a>5. 泛型代码和虚拟机</h2><p>虚拟机没有泛型类型对象——所有对象都属于普通类。接下来我们来学习编译器是如何“擦除”类型参数，以及这个过程对Java会产生什么影响。</p>
<h3 id="5-1-类型擦除"><a href="#5-1-类型擦除" class="headerlink" title="5.1 类型擦除"></a>5.1 类型擦除</h3><p>无论何时定义一个泛型类型，都会自动提供一个相应的<strong>原始类型</strong>。</p>
<ul>
<li>这个原始类型的名字就是去掉类型参数后的泛型类型名。</li>
<li>类型变量会被擦除</li>
<li>替换为其限定类（对于无限定类的会替换为Object）</li>
</ul>
<p>看上面的<code>Pair</code>类，因为没有限定类型，会被替换成<code>Object</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pair</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> Object first;</span><br><span class="line">  <span class="keyword">private</span> Object second;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">()</span> &#123;</span><br><span class="line">    first = <span class="literal">null</span>;</span><br><span class="line">    second = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(Object first, Object second)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.first = first;</span><br><span class="line">    <span class="built_in">this</span>.second = second;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> Object <span class="title function_">getFirst</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> first;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> Object <span class="title function_">getSecond</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> second;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFirst</span><span class="params">(Object newValue)</span> &#123;</span><br><span class="line">    first = newValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-转换泛型表达式"><a href="#5-2-转换泛型表达式" class="headerlink" title="5.2 转换泛型表达式"></a>5.2 转换泛型表达式</h3><p>编写一个泛型方法或泛型字段调用时，如果擦除了返回类型，编译器会插入强制类型转换。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Pair&lt;Employee&gt; buddies = ...;</span><br><span class="line"><span class="type">Employee</span> <span class="variable">buddy</span> <span class="operator">=</span> buddies.getFirst();</span><br></pre></td></tr></table></figure>

<p><code>getFirst</code>擦除类型后返回的是<code>Object</code>，编译器自动插入转换到<code>Employee</code>的强制类型转换。</p>
<ul>
<li>对原始<code>Pair.getFirst</code>方法进行调用</li>
<li>将返回的<code>Object</code>类型强制转换为<code>Employee</code>类型</li>
</ul>
<h2 id="5-3-转换泛型方法"><a href="#5-3-转换泛型方法" class="headerlink" title="5.3 转换泛型方法"></a>5.3 转换泛型方法</h2><p>类型擦除也会发生在泛型方法中。<strong>这里注意使用了桥方法保证多态。</strong></p>
<h2 id="6-限制与局限性"><a href="#6-限制与局限性" class="headerlink" title="6. 限制与局限性"></a>6. 限制与局限性</h2><p>下面来看以下使用Java泛型时需要考虑的一些限制。</p>
<h3 id="6-1-不能用基本类型代替参数类型"><a href="#6-1-不能用基本类型代替参数类型" class="headerlink" title="6.1 不能用基本类型代替参数类型"></a>6.1 不能用基本类型代替参数类型</h3><p>因为原型擦除后，会含有<code>Object</code>字段，而这个字段无法存储基本类型</p>
<h3 id="6-2-运行时类型查询只适用于原始类型"><a href="#6-2-运行时类型查询只适用于原始类型" class="headerlink" title="6.2 运行时类型查询只适用于原始类型"></a>6.2 运行时类型查询只适用于原始类型</h3><p>虚拟机中的对象总有一个特定的泛型类型。因此所有的类型查询只产生原始类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(a <span class="keyword">instanceof</span> Pair&lt;String&gt;); <span class="comment">// Error</span></span><br><span class="line"><span class="keyword">if</span>(a <span class="keyword">instanceof</span> Pair&lt;T&gt;); <span class="comment">// Error</span></span><br><span class="line">Pair&lt;String&gt; p = (Pair&lt;String&gt;) a; <span class="comment">//Error</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-不能创建参数化类型的数组"><a href="#6-3-不能创建参数化类型的数组" class="headerlink" title="6.3 不能创建参数化类型的数组"></a>6.3 不能创建参数化类型的数组</h3><p>数组会记住它的元素类型，如果试图存储其他类型的元素，会抛出错误。</p>
<h3 id="6-4-Varargs警告"><a href="#6-4-Varargs警告" class="headerlink" title="6.4 Varargs警告"></a>6.4 Varargs警告</h3><h3 id="6-5-不能实例化类型变量"><a href="#6-5-不能实例化类型变量" class="headerlink" title="6.5 不能实例化类型变量"></a>6.5 不能实例化类型变量</h3><h3 id="6-6-不能构造泛型数组"><a href="#6-6-不能构造泛型数组" class="headerlink" title="6.6 不能构造泛型数组"></a>6.6 不能构造泛型数组</h3><h3 id="6-7-泛型类的静态上下文中类型变量无效"><a href="#6-7-泛型类的静态上下文中类型变量无效" class="headerlink" title="6.7 泛型类的静态上下文中类型变量无效"></a>6.7 泛型类的静态上下文中类型变量无效</h3><h3 id="6-8-不能抛出或捕获泛型类的实例"><a href="#6-8-不能抛出或捕获泛型类的实例" class="headerlink" title="6.8 不能抛出或捕获泛型类的实例"></a>6.8 不能抛出或捕获泛型类的实例</h3><h3 id="6-9-可以取消对检查类型异常的检查"><a href="#6-9-可以取消对检查类型异常的检查" class="headerlink" title="6.9 可以取消对检查类型异常的检查"></a>6.9 可以取消对检查类型异常的检查</h3><h3 id="6-10-擦除后的冲突"><a href="#6-10-擦除后的冲突" class="headerlink" title="6.10 擦除后的冲突"></a>6.10 擦除后的冲突</h3><h2 id="7-泛型类的继承规则"><a href="#7-泛型类的继承规则" class="headerlink" title="7. 泛型类的继承规则"></a>7. 泛型类的继承规则</h2><h2 id="8-通配符类型"><a href="#8-通配符类型" class="headerlink" title="8. 通配符类型"></a>8. 通配符类型</h2><h2 id="9-反射和泛型"><a href="#9-反射和泛型" class="headerlink" title="9. 反射和泛型"></a>9. 反射和泛型</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/08/Java%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1%E4%B8%8E%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/08/Java%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1%E4%B8%8E%E7%B1%BB/" class="post-title-link" itemprop="url">Java中的对象与类</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-08 17:06:13" itemprop="dateCreated datePublished" datetime="2021-11-08T17:06:13+08:00">2021-11-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:47:35" itemprop="dateModified" datetime="2023-05-07T17:47:35+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-面向的对象程序设计概述"><a href="#1-面向的对象程序设计概述" class="headerlink" title="1. 面向的对象程序设计概述"></a>1. 面向的对象程序设计概述</h2><h3 id="1-1-类"><a href="#1-1-类" class="headerlink" title="1.1 类"></a>1.1 类</h3><p><strong>定义：</strong>类是构造对象的模板或蓝图。由类构造对象的过程称为创建类的实例。</p>
<p><strong>封装：</strong>是处理对象的一个重要概念。从行为上来看封装就是将数据和行为组合在一个包中，并对对象的使用者隐藏具体的实现方法。</p>
<ul>
<li>其中对象的数据称为<strong>实例字段</strong></li>
<li>操作数据的过程称为<strong>方法</strong></li>
</ul>
<p><strong>继承：</strong>通过扩展一个类来建立另一个类的过程称为继承</p>
<h3 id="1-2-对象"><a href="#1-2-对象" class="headerlink" title="1.2 对象"></a>1.2 对象</h3><ul>
<li>同一个类的所有对象实例，由于支持相同的行为而具有家族式的<strong>相似性</strong>。</li>
<li>每个对象都保存着当前描述当前状况的信息，这就是对象的<strong>状态</strong>。<ul>
<li>对象的状态可能会随时间发生改变，但不是自发的</li>
<li>对象状态的改变必须通过调用方法实现</li>
</ul>
</li>
<li>每一个对象都有一个唯一的标识。作为同一个类的实例，每个对象的标识总是不同的，状态往往也存在着差异。</li>
</ul>
<h3 id="1-3-类之间的关系"><a href="#1-3-类之间的关系" class="headerlink" title="1.3 类之间的关系"></a>1.3 类之间的关系</h3><p>类之间最常见的关系有：</p>
<ul>
<li>依赖（“uses-a”）</li>
<li>聚合（“has-a”）</li>
<li>继承（“is-a”）</li>
</ul>
<h2 id="2-自定义类"><a href="#2-自定义类" class="headerlink" title="2. 自定义类"></a>2. 自定义类</h2><p>类 &#x3D; 构造器 + 实例字段 + 方法</p>
<h3 id="2-1-构造器"><a href="#2-1-构造器" class="headerlink" title="2.1 构造器"></a>2.1 构造器</h3><ul>
<li>构造器与类同名</li>
<li>每个类可以有一个以上的构造器</li>
<li>构造器可以有0个、1个或多个参数</li>
<li>构造器没有返回值</li>
<li>构造器总是伴随着new操作符一起调用</li>
</ul>
<p><strong>1. 重载</strong></p>
<p>一个类可以有多个构造器，这种功能叫做重载。编译器必须挑出具体的方法：</p>
<ul>
<li>如果匹配不到适合的参数，就会编译错误</li>
<li>如果找到合适的，就会调用该构造器</li>
</ul>
<p><strong>2. 默认字段初始化</strong></p>
<p>如果构造器中没有显示地为字段设置初始值，那么就会被自动的赋为默认值：</p>
<ul>
<li>数值：0</li>
<li>布尔值：false</li>
<li>对象：null</li>
</ul>
<p><strong>3. 无参数的构造器</strong></p>
<p>很多类都会包含一个无参数构造器，又无参数构造器创建对象时，对象状态会置为适当的默认值</p>
<ul>
<li>如果一个类没有编写构造器，则会默认提供一个无参数构造器</li>
<li>如果一个类提供了一个构造器（不是无参数构造器），那么构造对象时如果不提供参数就会报错</li>
</ul>
<p><strong>4. 初始化数据字段</strong></p>
<ul>
<li>构造器中设置</li>
<li>声明中设置</li>
<li>使用初始化块</li>
</ul>
<h3 id="2-2-隐式参数与显示参数"><a href="#2-2-隐式参数与显示参数" class="headerlink" title="2.2 隐式参数与显示参数"></a>2.2 隐式参数与显示参数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> salary</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">raiseSalary</span><span class="params">(<span class="type">double</span> byPercent)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">raise</span> <span class="operator">=</span> salary * byPercent / <span class="number">100</span>;</span><br><span class="line">        salary += raise</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们调用这个方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Employee</span> <span class="variable">number007</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1000</span>)</span><br><span class="line">number007.raiseSalary(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>其实执行的具体过程如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="variable">raise</span> <span class="operator">=</span> number007.salary * byPercent / <span class="number">100</span>;</span><br><span class="line">number007.salary += raise</span><br></pre></td></tr></table></figure>

<p><code>raiseSalary</code>有两个参数：</p>
<ul>
<li><p>隐式参数，就是这里的<code>number007</code>。关键字this可以指向隐式参数，因此这个方法可以这样写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">raiseSalary</span><span class="params">(<span class="type">double</span> byPercent)</span> &#123;</span><br><span class="line">    <span class="type">double</span> <span class="variable">raise</span> <span class="operator">=</span> <span class="built_in">this</span>.salary * byPercent / <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">this</span>.salary += raise</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示参数，跟在方法名后括号中的数值</p>
</li>
</ul>
<h3 id="2-3-基于类的访问权限"><a href="#2-3-基于类的访问权限" class="headerlink" title="2.3 基于类的访问权限"></a>2.3 基于类的访问权限</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Employee other)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name.equals(other.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(harry.equals(boss)) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为<code>boss</code>是<code>Employee</code>类型的对象，而<code>Employee</code>类的方法可以访问任何<code>Employee</code>类型对象的私有字段</p>
<h3 id="2-4-私有方法"><a href="#2-4-私有方法" class="headerlink" title="2.4 私有方法"></a>2.4 私有方法</h3><p>大多数方法设计为公共的，但在一些情况下设计成私有的更有用：</p>
<ul>
<li>一个公共函数的辅助方法，不需要称为公共接口的一部分</li>
</ul>
<h3 id="2-5-final-实例字段"><a href="#2-5-final-实例字段" class="headerlink" title="2.5 final 实例字段"></a>2.5 final 实例字段</h3><p>定义为final的实例字段，必须确保在每一个构造器执行之后，这个字段已经被设置，并且以后不能修改这个字段</p>
<h2 id="3-静态字段和静态方法"><a href="#3-静态字段和静态方法" class="headerlink" title="3. 静态字段和静态方法"></a>3. 静态字段和静态方法</h2><p>接下来我们讨论<code>static</code>修饰符</p>
<h3 id="3-1-静态字段"><a href="#3-1-静态字段" class="headerlink" title="3.1 静态字段"></a>3.1 静态字段</h3><p>如果将一个字段定义为<code>static</code>，那么它将属于这个类：</p>
<ul>
<li>非静态的实例字段，每个对象都有一个自己的副本</li>
<li>静态字段只属于类，这个类的所有实例共享一个静态字段</li>
</ul>
<h3 id="3-2-静态常量"><a href="#3-2-静态常量" class="headerlink" title="3.2 静态常量"></a>3.2 静态常量</h3><p><code>Math</code>类中的<code>PI</code>就是一个静态常量</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Math</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">double</span> <span class="variable">PI</span> <span class="operator">=</span> <span class="number">3.1415926</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里还添加了<code>final</code>防止其值被恶意修改</p>
<h3 id="3-3-静态方法"><a href="#3-3-静态方法" class="headerlink" title="3.3 静态方法"></a>3.3 静态方法</h3><p>静态方法不是在对象上执行的方法，如<code>Math.pow()</code>。</p>
<ul>
<li>可以认为静态方法是没有<code>this</code>参数的方法</li>
<li>静态方法不可以访问实例字段，但是可以访问静态字段</li>
</ul>
<p>以下两种场景适合使用静态方法：</p>
<ul>
<li>方法不需要访问对象的状态，所有的参数由显示参数提供</li>
<li>方法只需要访问类的静态字段</li>
</ul>
<h3 id="3-4-工厂方法"><a href="#3-4-工厂方法" class="headerlink" title="3.4 工厂方法"></a>3.4 工厂方法</h3><p>类似<code>LocalDate</code>和<code>NumberFormat</code>的类使用静态工厂方法来构造对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NumberFormat</span> <span class="variable">currencyFormatter</span> <span class="operator">=</span> NumberFormat.getCurrencyInstance();</span><br><span class="line"><span class="type">NumberFormat</span> <span class="variable">precentFormatter</span> <span class="operator">=</span> NumberFormat.getPrecentInstance();</span><br><span class="line"><span class="type">double</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0.1</span>;</span><br><span class="line">System.out.println(currencyFormatter.format(x)); <span class="comment">// $0.10</span></span><br><span class="line">System.out.println(precentFormatter.format(x)); <span class="comment">// 10%</span></span><br></pre></td></tr></table></figure>

<p>这里没有采用构造器有如下原因：</p>
<ul>
<li>构造器必须与类名相同，但是这里希望两个不同的名字，分别得到货币的实例和百分比</li>
<li>使用构造器时无法改变构造对象的类型。而工厂方法实际上将返回<code>DecimalFormat</code>类的对象，这是<code>NumberFormat</code>的子类。</li>
</ul>
<h3 id="3-5-main方法"><a href="#3-5-main方法" class="headerlink" title="3.5 main方法"></a>3.5 main方法</h3><p><code>main</code>是一个静态方法，<code>main</code>不对任何对象进行操作。</p>
<ul>
<li>每一个类都可以有一个<code>main</code>方法，可以以此进行单元测试</li>
</ul>
<h2 id="4-方法参数"><a href="#4-方法参数" class="headerlink" title="4. 方法参数"></a>4. 方法参数</h2><p>Java程序设计总是按值调用，和js一样，不再赘述。</p>
<h2 id="5-包"><a href="#5-包" class="headerlink" title="5. 包"></a>5. 包</h2><p>包可以将类组织在一个集合中，能够帮助我们方便的组织自己的代码，并将自己的代码和别人提供的代码库分开管理。</p>
<h3 id="5-1-类的导入"><a href="#5-1-类的导入" class="headerlink" title="5.1 类的导入"></a>5.1 类的导入</h3><p>一个类可以使用所属包中的所有类，以及其他包中的公共类</p>
<p>访问公共类的两种方式：</p>
<ul>
<li><p>使用完全限定名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.time.<span class="type">LocalDate</span> <span class="variable">today</span> <span class="operator">=</span> java.time.LocalDate.now();</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<code>import</code>语句</p>
<ul>
<li><p>引入全部的包（注意使用*只能导入一个包）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.*;</span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">today</span> <span class="operator">=</span> LocalDate.now();</span><br></pre></td></tr></table></figure>
</li>
<li><p>引入特定的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">today</span> <span class="operator">=</span> LocalDate.now();</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="5-2-静态导入"><a href="#5-2-静态导入" class="headerlink" title="5.2 静态导入"></a>5.2 静态导入</h3><ul>
<li><p>导入静态字段和方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.System.*;</span><br><span class="line"></span><br><span class="line">out.println(<span class="string">&quot;hello world&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>导入特定静态字段和方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.System.out;</span><br><span class="line"></span><br><span class="line">out.println(<span class="string">&quot;hello world&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-3-在包中添加类"><a href="#5-3-在包中添加类" class="headerlink" title="5.3 在包中添加类"></a>5.3 在包中添加类</h3><p>使用<code>package</code>将类放入包中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.horstman.corejava;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果没有在开头使用<code>package</code>，这个源文件中的类就属于<strong>无名包</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/06/go%E7%9A%84%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wk">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wk的博客">
      <meta itemprop="description" content="一个前端程序员">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | wk的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/06/go%E7%9A%84%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">go的数据结构</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-06 17:06:13" itemprop="dateCreated datePublished" datetime="2021-11-06T17:06:13+08:00">2021-11-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-07 17:47:01" itemprop="dateModified" datetime="2023-05-07T17:47:01+08:00">2023-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%90%8E%E7%AB%AF/go/" itemprop="url" rel="index"><span itemprop="name">go</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p><strong>方法的声明：</strong> 在函数声明时，在其名字之前放上一个变量，即是一个方法。这个附加的参数会将该函数附加到这种类型上，即相当于为这种类型定义了一个独占的方法。</p>
<p>下面的代码里那个附加的参数p，叫做方法的接收器（receiver）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> geometry</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;math&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Point <span class="keyword">struct</span>&#123; X, Y <span class="type">float64</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// traditional function</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Distance</span><span class="params">(p, q Point)</span></span> <span class="type">float64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> math.Hypot(q.X-p.X, q.Y-p.Y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// same thing, but as a method of the Point type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Point)</span></span> Distance(q Point) <span class="type">float64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> math.Hypot(q.X-p.X, q.Y-p.Y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>方法的调用：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p := Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">q := Point&#123;<span class="number">4</span>, <span class="number">6</span>&#125;</span><br><span class="line">fmt.Println(Distance(p, q)) <span class="comment">// &quot;5&quot;, function call</span></span><br><span class="line">fmt.Println(p.Distance(q))  <span class="comment">// &quot;5&quot;, method call</span></span><br></pre></td></tr></table></figure>



<h2 id="基于指针对象的方法"><a href="#基于指针对象的方法" class="headerlink" title="基于指针对象的方法"></a>基于指针对象的方法</h2><p>我们就可以用其指针而不是对象来声明方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Point)</span></span> ScaleBy(factor <span class="type">float64</span>) &#123;</span><br><span class="line">    p.X *= factor</span><br><span class="line">    p.Y *= factor</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在声明方法时，如果一个类型名本身是一个指针的话，是不允许其出现在接收器中的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> P *<span class="type">int</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(P)</span></span> f() &#123; <span class="comment">/* ... */</span> &#125; <span class="comment">// compile error: invalid receiver type</span></span><br></pre></td></tr></table></figure>

<p>调用指针类型方法<code>(*Point).ScaleBy</code>，只要提供一个Point类型的指针即可</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// plan1</span></span><br><span class="line">r := &amp;Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">r.ScaleBy(<span class="number">2</span>)</span><br><span class="line">fmt.Println(*r) <span class="comment">// &quot;&#123;2, 4&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// plan2</span></span><br><span class="line">p := Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">pptr := &amp;p</span><br><span class="line">pptr.ScaleBy(<span class="number">2</span>)</span><br><span class="line">fmt.Println(p) <span class="comment">// &quot;&#123;2, 4&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//plan3</span></span><br><span class="line">p := Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">(&amp;p).ScaleBy(<span class="number">2</span>)</span><br><span class="line">fmt.Println(p) <span class="comment">// &quot;&#123;2, 4&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>不过后面两种方法有些笨拙。幸运的是，go语言本身在这种地方会帮到我们。如果接收器p是一个Point类型的变量，并且其方法需要一个Point指针作为接收器，我们可以用下面这种简短的写法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.ScaleBy(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>编译器会隐式地帮我们用&amp;p去调用ScaleBy这个方法。这种简写方法只适用于“变量”，包括struct里的字段比如p.X，以及array和slice内的元素比如perim[0]。我们不能通过一个无法取到地址的接收器来调用指针方法，比如临时变量的内存地址就无法获取得到：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;.ScaleBy(<span class="number">2</span>) <span class="comment">// compile error: can&#x27;t take address of Point literal</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wk</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
